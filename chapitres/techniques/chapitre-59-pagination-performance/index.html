<!doctype html><html lang=fr-fr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><title>Chapitre 59 : Pagination et Performance | DDD Adventure</title><meta name=robots content="noindex"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Pagination et performance dans le Gyroscops Cloud avec des exemples concrets"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=http://localhost:1313/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=http://localhost:1313/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=http://localhost:1313/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=http://localhost:1313/site.webmanifest><meta property="og:title" content="Chapitre 59 : Pagination et Performance"><meta property="og:description" content="Pagination et performance dans le Gyroscops Cloud avec des exemples concrets"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/chapitres/techniques/chapitre-59-pagination-performance/"><meta property="og:image" content="http://localhost:1313/opengraph/card-base-2_hu_a70601b8292b23c.png"><meta property="article:section" content="chapitres"><meta property="article:published_time" content="2024-12-19T00:00:00+00:00"><meta property="article:modified_time" content="2024-12-19T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/opengraph/card-base-2_hu_a70601b8292b23c.png"><meta name=twitter:title content="Chapitre 59 : Pagination et Performance"><meta name=twitter:description content="Pagination et performance dans le Gyroscops Cloud avec des exemples concrets"><link rel=alternate type=application/atom+xml title="Atom feed for DDD Adventure" href=/index.xml><script type=text/javascript src=http://localhost:1313/docs/js/flexsearch.bundle.js></script><link rel=stylesheet href=/docs/scss/style.css crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres Fondamentaux</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-01-introduction-event-storming-ddd/>Chapitre 1 : Introduction au Domain-Driven Design et Event Storming</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-02-impact-mapping/>Chapitre 2 : L'Impact Mapping - Aligner le Produit sur les Objectifs Business</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-03-atelier-event-storming/>Chapitre 3 : L'Atelier Event Storming - Guide Pratique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-04-example-mapping/>Chapitre 4 : L'Example Mapping - DÃ©tailer les RÃ¨gles MÃ©tier</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-05-complexite-accidentelle-essentielle/>Chapitre 5 : ComplexitÃ© Accidentelle vs Essentielle - Le Choix Architectural</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-06-granularite-choix-architecturaux/>Chapitre 6 : GranularitÃ© des Choix Architecturaux</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-07-modeles-riches-vs-anemiques/>Chapitre 7 : ModÃ¨les Riches vs ModÃ¨les AnÃ©miques</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-08-architecture-evenementielle/>Chapitre 8 : Architecture Ã‰vÃ©nementielle</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-09-repositories-persistance/>Chapitre 9 : Repositories et Persistance</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-10-choix-type-stockage/>Chapitre 15 : Choix du Type de Stockage</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres Optionnels</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-13-architecture-cqrs/>Chapitre 15 : Architecture CQRS avec API Platform</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-12-architecture-cqs/>Chapitre 15 : Architecture CQS - Command Query Separation</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-11-event-sourcing/>Chapitre 15 : Event Sourcing - La Source de VÃ©ritÃ©</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-14-cqrs-event-sourcing-combines/>Chapitre 15 : CQRS + Event Sourcing CombinÃ©s</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-15-projections-event-sourcing/>Chapitre 15 : Projections Event Sourcing</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres de Stockage</button><div class=sidebar-submenu><ul><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage SQL</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-16-stockage-sql-classique/>Chapitre 16 : Stockage SQL - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-17-stockage-sql-cqs/>Chapitre 17 : Stockage SQL - Approche CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-18-stockage-sql-cqrs/>Chapitre 18 : Stockage SQL - Approche CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-19-stockage-sql-event-sourcing/>Chapitre 19 : Stockage SQL - Event Sourcing Seul</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-20-stockage-sql-event-sourcing-cqs/>Chapitre 58 : Stockage SQL - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-21-stockage-sql-event-sourcing-cqrs/>Chapitre 59 : Stockage SQL - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage API</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-26-stockage-api-event-sourcing-cqs/>Chapitre 26 : Stockage API - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-27-stockage-api-event-sourcing-cqrs/>Chapitre 27 : Stockage API - Event Sourcing + CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-22-stockage-api-classique/>Chapitre 60 : Stockage API - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-23-stockage-api-cqs/>Chapitre 61 : Stockage API - Approche CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-24-stockage-api-cqrs/>Chapitre 62 : Stockage API - Approche CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-25-stockage-api-event-sourcing/>Chapitre 63 : Stockage API - Event Sourcing Seul</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage MongoDB</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-28-stockage-mongodb-classique/>Chapitre 28 : Stockage MongoDB - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-29-stockage-mongodb-cqs/>Chapitre 29 : Stockage MongoDB - Approche CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-30-stockage-mongodb-cqrs/>Chapitre 30 : Stockage MongoDB - Approche CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-31-stockage-mongodb-event-sourcing/>Chapitre 31 : Stockage MongoDB - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-32-stockage-mongodb-event-sourcing-cqs/>Stockage MongoDB - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-33-stockage-mongodb-event-sourcing-cqrs/>Stockage MongoDB - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage ElasticSearch</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-34-stockage-elasticsearch-classique/>Stockage ElasticSearch - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-35-stockage-elasticsearch-cqs/>Stockage ElasticSearch - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-36-stockage-elasticsearch-cqrs/>Stockage ElasticSearch - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-37-stockage-elasticsearch-event-sourcing/>Stockage ElasticSearch - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-38-stockage-elasticsearch-event-sourcing-cqs/>Stockage ElasticSearch - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-39-stockage-elasticsearch-event-sourcing-cqrs/>Stockage ElasticSearch - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage In-Memory</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-40-stockage-in-memory-classique/>Stockage In-Memory - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-41-stockage-in-memory-cqs/>Stockage In-Memory - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-42-stockage-in-memory-cqrs/>Stockage In-Memory - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-43-stockage-in-memory-event-sourcing/>Stockage In-Memory - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-44-stockage-in-memory-event-sourcing-cqs/>Stockage In-Memory - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-45-stockage-in-memory-event-sourcing-cqrs/>Stockage In-Memory - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage Composite pilotÃ© par Temporal</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-46-stockage-temporal-classique/>Stockage Temporal - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-47-stockage-temporal-cqs/>Stockage Temporal - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-48-stockage-temporal-cqrs/>Stockage Temporal - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-49-stockage-temporal-event-sourcing/>Stockage Temporal - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-50-stockage-temporal-event-sourcing-cqs/>Stockage Temporal - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-51-stockage-temporal-event-sourcing-cqrs/>Stockage Temporal - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage Multi-sources</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-52-stockage-multi-sources-classique/>Stockage Multi-sources - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-53-stockage-multi-sources-cqs/>Stockage Multi-sources - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-54-stockage-multi-sources-cqrs/>Stockage Multi-sources - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-55-stockage-multi-sources-event-sourcing/>Stockage Multi-sources avec Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-56-stockage-multi-sources-strategies-avancees/>StratÃ©gies AvancÃ©es de RÃ©plication Multi-sources</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-57-stockage-multi-sources-resolution-conflits/>RÃ©solution de Conflits Multi-sources</a></li></ul></div></li></ul></div></li><li class="sidebar-dropdown no-icon current active"><button class=btn>
Chapitres Techniques</button><div class="sidebar-submenu d-block"><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-58-gestion-donnees-validation/>Chapitre 58 : Gestion des DonnÃ©es et Validation</a></li><li class="current no-icon"><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-59-pagination-performance/>Chapitre 59 : Pagination et Performance</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-60-gestion-erreurs-observabilite/>Chapitre 60 : Gestion d'Erreurs et ObservabilitÃ©</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-61-tests-qualite/>Chapitre 61 : Tests et QualitÃ©</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres AvancÃ©s</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/avances/chapitre-62-securite-autorisation/>Chapitre 62 : SÃ©curitÃ© et Autorisation - ProtÃ©ger votre API Platform</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/avances/chapitre-63-frontend-integration/>Chapitre 63 : Frontend et IntÃ©gration - Connecter votre Interface Utilisateur</a></li></ul></div></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentColor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentColor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentColor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentColor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentColor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentColor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentColor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://twitter.com/gplanchat alt=twitter rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24"><title>Twitter / X</title><path d="M.088.768l9.266 12.39L.029 23.231h2.1l8.163-8.819 6.6 8.819h7.142L14.242 10.145 22.921.768h-2.1L13.3 8.891 7.229.768zM3.174 2.314H6.455L20.942 21.685h-3.28z" fill="currentColor"/></svg></div></a></li></ul></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/chapitres/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/chapitres/techniques/><span itemprop=name>Chapitres Techniques</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Chapitre 59 : Pagination et Performance</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=TableOfContents><ul><li><a href=#-objectif-de-ce-chapitre>ğŸ¯ Objectif de ce Chapitre</a><ul><li><a href=#rÃ©fÃ©rences-aux-adr-du-projet-gyroscops-cloud>RÃ©fÃ©rences aux ADR du Projet Gyroscops Cloud</a></li></ul></li><li><a href=#-architecture-de-la-pagination>ğŸ—ï¸ Architecture de la Pagination</a><ul><li><a href=#structure-de-pagination>Structure de Pagination</a></li><li><a href=#interfaces-de-pagination>Interfaces de Pagination</a></li></ul></li><li><a href=#-pagination-par-offset>ğŸ“„ Pagination par Offset</a><ul><li><a href=#service-de-pagination-par-offset>Service de Pagination par Offset</a></li><li><a href=#repository-avec-pagination-par-offset>Repository avec Pagination par Offset</a></li></ul></li><li><a href=#-pagination-par-curseur>ğŸ¯ Pagination par Curseur</a><ul><li><a href=#service-de-pagination-par-curseur>Service de Pagination par Curseur</a></li><li><a href=#repository-avec-pagination-par-curseur>Repository avec Pagination par Curseur</a></li></ul></li><li><a href=#-optimisation-des-performances>âš¡ Optimisation des Performances</a><ul><li><a href=#optimisation-des-requÃªtes>Optimisation des RequÃªtes</a></li><li><a href=#cache-de-pagination>Cache de Pagination</a></li></ul></li><li><a href=#-tests-de-pagination>ğŸ§ª Tests de Pagination</a><ul><li><a href=#test-de-pagination-par-offset>Test de Pagination par Offset</a></li><li><a href=#test-de-pagination-par-curseur>Test de Pagination par Curseur</a></li></ul></li><li><a href=#-bonnes-pratiques-du-projet-gyroscops-cloud>ğŸ—ï¸ Bonnes Pratiques du Projet Gyroscops Cloud</a><ul><li><a href=#pagination-selon-hive037-et-hive039>Pagination selon HIVE037 et HIVE039</a></li><li><a href=#optimisation-des-requÃªtes-selon-hive035>Optimisation des RequÃªtes selon HIVE035</a></li><li><a href=#cache-de-pagination-selon-hive013>Cache de Pagination selon HIVE013</a></li><li><a href=#tests-de-pagination-selon-hive027>Tests de Pagination selon HIVE027</a></li></ul></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#-objectif-de-ce-chapitre>ğŸ¯ Objectif de ce Chapitre</a><ul><li><a href=#rÃ©fÃ©rences-aux-adr-du-projet-gyroscops-cloud>RÃ©fÃ©rences aux ADR du Projet Gyroscops Cloud</a></li></ul></li><li><a href=#-architecture-de-la-pagination>ğŸ—ï¸ Architecture de la Pagination</a><ul><li><a href=#structure-de-pagination>Structure de Pagination</a></li><li><a href=#interfaces-de-pagination>Interfaces de Pagination</a></li></ul></li><li><a href=#-pagination-par-offset>ğŸ“„ Pagination par Offset</a><ul><li><a href=#service-de-pagination-par-offset>Service de Pagination par Offset</a></li><li><a href=#repository-avec-pagination-par-offset>Repository avec Pagination par Offset</a></li></ul></li><li><a href=#-pagination-par-curseur>ğŸ¯ Pagination par Curseur</a><ul><li><a href=#service-de-pagination-par-curseur>Service de Pagination par Curseur</a></li><li><a href=#repository-avec-pagination-par-curseur>Repository avec Pagination par Curseur</a></li></ul></li><li><a href=#-optimisation-des-performances>âš¡ Optimisation des Performances</a><ul><li><a href=#optimisation-des-requÃªtes>Optimisation des RequÃªtes</a></li><li><a href=#cache-de-pagination>Cache de Pagination</a></li></ul></li><li><a href=#-tests-de-pagination>ğŸ§ª Tests de Pagination</a><ul><li><a href=#test-de-pagination-par-offset>Test de Pagination par Offset</a></li><li><a href=#test-de-pagination-par-curseur>Test de Pagination par Curseur</a></li></ul></li><li><a href=#-bonnes-pratiques-du-projet-gyroscops-cloud>ğŸ—ï¸ Bonnes Pratiques du Projet Gyroscops Cloud</a><ul><li><a href=#pagination-selon-hive037-et-hive039>Pagination selon HIVE037 et HIVE039</a></li><li><a href=#optimisation-des-requÃªtes-selon-hive035>Optimisation des RequÃªtes selon HIVE035</a></li><li><a href=#cache-de-pagination-selon-hive013>Cache de Pagination selon HIVE013</a></li><li><a href=#tests-de-pagination-selon-hive027>Tests de Pagination selon HIVE027</a></li></ul></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><h1 class="content-title mb-0">Chapitre 59 : Pagination et Performance
<span class="badge bg-default fs-6 mb-1 align-middle">DRAFT</span></h1></div><div id=content class=main-content><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h2 id=-objectif-de-ce-chapitre>ğŸ¯ Objectif de ce Chapitre <a href=#-objectif-de-ce-chapitre class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>Ce chapitre vous montre comment implÃ©menter la pagination et optimiser les performances dans le Gyroscops Cloud. Vous apprendrez :</p><ul><li>Comment implÃ©menter la pagination efficace</li><li>Comment optimiser les performances des requÃªtes</li><li>Comment gÃ©rer les grandes quantitÃ©s de donnÃ©es</li><li>Comment tester la pagination</li></ul><h3 id=rÃ©fÃ©rences-aux-adr-du-projet-gyroscops-cloud>RÃ©fÃ©rences aux ADR du Projet Gyroscops Cloud <a href=#r%c3%a9f%c3%a9rences-aux-adr-du-projet-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Ce chapitre s&rsquo;appuie sur les Architecture Decision Records (ADR) suivants du Gyroscops Cloud :</p><ul><li><strong>HIVE037</strong> : Pagination Implementation Guidelines - Guidelines d&rsquo;implÃ©mentation de la pagination</li><li><strong>HIVE039</strong> : Cursor-Based Pagination - Pagination basÃ©e sur les curseurs</li><li><strong>HIVE013</strong> : Collection Management - Gestion des collections</li><li><strong>HIVE014</strong> : ElasticSearch Repositories - Repositories ElasticSearch</li><li><strong>HIVE027</strong> : PHPUnit Testing Standards - Standards de test PHPUnit</li></ul><h2 id=-architecture-de-la-pagination>ğŸ—ï¸ Architecture de la Pagination <a href=#-architecture-de-la-pagination class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=structure-de-pagination>Structure de Pagination <a href=#structure-de-pagination class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><pre tabindex=0><code>api/src/
â”œâ”€â”€ Platform/
â”‚   â”œâ”€â”€ Domain/
â”‚   â”‚   â”œâ”€â”€ Pagination/
â”‚   â”‚   â”‚   â”œâ”€â”€ PaginationRequest.php
â”‚   â”‚   â”‚   â”œâ”€â”€ PaginationResponse.php
â”‚   â”‚   â”‚   â”œâ”€â”€ CursorPaginationRequest.php
â”‚   â”‚   â”‚   â””â”€â”€ CursorPaginationResponse.php
â”‚   â”‚   â””â”€â”€ ValueObjects/
â”‚   â”‚       â”œâ”€â”€ PageNumber.php
â”‚   â”‚       â”œâ”€â”€ PageSize.php
â”‚   â”‚       â””â”€â”€ Cursor.php
â”‚   â””â”€â”€ Infrastructure/
â”‚       â”œâ”€â”€ Pagination/
â”‚       â”‚   â”œâ”€â”€ OffsetPaginationService.php
â”‚       â”‚   â”œâ”€â”€ CursorPaginationService.php
â”‚       â”‚   â””â”€â”€ PaginationValidator.php
â”‚       â””â”€â”€ Repositories/
â”‚           â”œâ”€â”€ PaginatedRepositoryInterface.php
â”‚           â””â”€â”€ CursorPaginatedRepositoryInterface.php</code></pre><h3 id=interfaces-de-pagination>Interfaces de Pagination <a href=#interfaces-de-pagination class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Interface de Pagination (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>findPaginated</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $pagination,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>findCursorPaginated</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CursorPaginationRequest</span> $pagination,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>CursorPaginationResponse</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PaginationRequest</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>int</span> $page,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>int</span> $pageSize,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>validate</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>validate</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidPaginationException</span>(<span style=color:#e6db74>&#39;Page must be greater than 0&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidPaginationException</span>(<span style=color:#e6db74>&#39;Page size must be between 1 and 100&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PaginationResponse</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#66d9ef>array</span> $data,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>int</span> $page,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>int</span> $pageSize,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>int</span> $totalItems,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>int</span> $totalPages,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>bool</span> $hasNextPage,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>bool</span> $hasPreviousPage
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getTotalItems</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>int</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>totalItems</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getTotalPages</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>int</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>totalPages</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>hasNextPage</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>hasPreviousPage</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=-pagination-par-offset>ğŸ“„ Pagination par Offset <a href=#-pagination-par-offset class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=service-de-pagination-par-offset>Service de Pagination par Offset <a href=#service-de-pagination-par-offset class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Service de Pagination par Offset (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OffsetPaginationService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span> $repository,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>paginate</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $request,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span> {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Paginating data&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageSize&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;filters&#39;</span> <span style=color:#f92672>=&gt;</span> $filters,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;sorting&#39;</span> <span style=color:#f92672>=&gt;</span> $sorting
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>findPaginated</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Pagination completed&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;totalItems&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalItems</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;totalPages&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalPages</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;hasNextPage&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;hasPreviousPage&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>()
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=repository-avec-pagination-par-offset>Repository avec Pagination par Offset <a href=#repository-avec-pagination-par-offset class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Repository avec Pagination par Offset (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SqlPaymentRepository</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Connection</span> $connection,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaymentHydrator</span> $hydrator
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>findPaginated</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $pagination,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span> {
</span></span><span style=display:flex><span>        $queryBuilder <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>connection</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createQueryBuilder</span>()
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>select</span>(<span style=color:#e6db74>&#39;*&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;payments&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply filters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyFilters</span>($queryBuilder, $filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply sorting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applySorting</span>($queryBuilder, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Get total count
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $totalItems <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalCount</span>($filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply pagination
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $offset <span style=color:#f92672>=</span> ($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>;
</span></span><span style=display:flex><span>        $queryBuilder
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setFirstResult</span>($offset)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setMaxResults</span>($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Execute query
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $result <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>        $rows <span style=color:#f92672>=</span> $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetchAllAssociative</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Hydrate entities
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $data <span style=color:#f92672>=</span> <span style=color:#a6e22e>array_map</span>(<span style=color:#a6e22e>fn</span>($row) <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrator</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrate</span>($row), $rows);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Calculate pagination metadata
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $totalPages <span style=color:#f92672>=</span> (<span style=color:#a6e22e>int</span>) <span style=color:#a6e22e>ceil</span>($totalItems <span style=color:#f92672>/</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>        $hasNextPage <span style=color:#f92672>=</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>&lt;</span> $totalPages;
</span></span><span style=display:flex><span>        $hasPreviousPage <span style=color:#f92672>=</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> $data,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalItems</span><span style=color:#f92672>:</span> $totalItems,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalPages</span><span style=color:#f92672>:</span> $totalPages,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> $hasNextPage,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> $hasPreviousPage
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>applyFilters</span>(<span style=color:#a6e22e>QueryBuilder</span> $queryBuilder, <span style=color:#66d9ef>array</span> $filters)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;status&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;status = :status&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;status&#39;</span>, $filters[<span style=color:#e6db74>&#39;status&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;organization_id&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;organization_id = :organization_id&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;organization_id&#39;</span>, $filters[<span style=color:#e6db74>&#39;organization_id&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;date_from&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;creation_date &gt;= :date_from&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;date_from&#39;</span>, $filters[<span style=color:#e6db74>&#39;date_from&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;date_to&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;creation_date &lt;= :date_to&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;date_to&#39;</span>, $filters[<span style=color:#e6db74>&#39;date_to&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;amount_min&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;total_amount &gt;= :amount_min&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;amount_min&#39;</span>, $filters[<span style=color:#e6db74>&#39;amount_min&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;amount_max&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;total_amount &lt;= :amount_max&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;amount_max&#39;</span>, $filters[<span style=color:#e6db74>&#39;amount_max&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>applySorting</span>(<span style=color:#a6e22e>QueryBuilder</span> $queryBuilder, <span style=color:#66d9ef>array</span> $sorting)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($sorting <span style=color:#66d9ef>as</span> $field <span style=color:#f92672>=&gt;</span> $direction) {
</span></span><span style=display:flex><span>            $allowedFields <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;creation_date&#39;</span>, <span style=color:#e6db74>&#39;total_amount&#39;</span>, <span style=color:#e6db74>&#39;status&#39;</span>, <span style=color:#e6db74>&#39;customer_name&#39;</span>];
</span></span><span style=display:flex><span>            $allowedDirections <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;ASC&#39;</span>, <span style=color:#e6db74>&#39;DESC&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>($field, $allowedFields) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>in_array</span>(<span style=color:#a6e22e>strtoupper</span>($direction), $allowedDirections)) {
</span></span><span style=display:flex><span>                $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addOrderBy</span>($field, <span style=color:#a6e22e>strtoupper</span>($direction));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Default sorting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>empty</span>($sorting)) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addOrderBy</span>(<span style=color:#e6db74>&#39;creation_date&#39;</span>, <span style=color:#e6db74>&#39;DESC&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getTotalCount</span>(<span style=color:#66d9ef>array</span> $filters)<span style=color:#f92672>:</span> <span style=color:#a6e22e>int</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $queryBuilder <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>connection</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createQueryBuilder</span>()
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>select</span>(<span style=color:#e6db74>&#39;COUNT(*)&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;payments&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyFilters</span>($queryBuilder, $filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>int</span>) $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetchOne</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=-pagination-par-curseur>ğŸ¯ Pagination par Curseur <a href=#-pagination-par-curseur class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=service-de-pagination-par-curseur>Service de Pagination par Curseur <a href=#service-de-pagination-par-curseur class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Service de Pagination par Curseur (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CursorPaginationService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span> $repository,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>paginate</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CursorPaginationRequest</span> $request,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>CursorPaginationResponse</span> {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Cursor paginating data&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;cursor&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursor</span><span style=color:#f92672>?-&gt;</span><span style=color:#a6e22e>toString</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pageSize&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;filters&#39;</span> <span style=color:#f92672>=&gt;</span> $filters,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;sorting&#39;</span> <span style=color:#f92672>=&gt;</span> $sorting
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>findCursorPaginated</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Cursor pagination completed&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;hasNextPage&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;hasPreviousPage&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;nextCursor&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>nextCursor</span><span style=color:#f92672>?-&gt;</span><span style=color:#a6e22e>toString</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;previousCursor&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>previousCursor</span><span style=color:#f92672>?-&gt;</span><span style=color:#a6e22e>toString</span>()
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=repository-avec-pagination-par-curseur>Repository avec Pagination par Curseur <a href=#repository-avec-pagination-par-curseur class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Repository avec Pagination par Curseur (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SqlPaymentRepository</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Connection</span> $connection,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaymentHydrator</span> $hydrator
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>findCursorPaginated</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CursorPaginationRequest</span> $pagination,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>CursorPaginationResponse</span> {
</span></span><span style=display:flex><span>        $queryBuilder <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>connection</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createQueryBuilder</span>()
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>select</span>(<span style=color:#e6db74>&#39;*&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;payments&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply filters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyFilters</span>($queryBuilder, $filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply cursor-based pagination
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyCursorPagination</span>($queryBuilder, $pagination);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply sorting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applySorting</span>($queryBuilder, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Execute query
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $result <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>        $rows <span style=color:#f92672>=</span> $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetchAllAssociative</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Hydrate entities
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $data <span style=color:#f92672>=</span> <span style=color:#a6e22e>array_map</span>(<span style=color:#a6e22e>fn</span>($row) <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrator</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrate</span>($row), $rows);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Calculate cursor metadata
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $hasNextPage <span style=color:#f92672>=</span> <span style=color:#a6e22e>count</span>($data) <span style=color:#f92672>===</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>;
</span></span><span style=display:flex><span>        $hasPreviousPage <span style=color:#f92672>=</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursor</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Generate cursors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $nextCursor <span style=color:#f92672>=</span> $hasNextPage <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($data) 
</span></span><span style=display:flex><span>            <span style=color:#f92672>?</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>generateCursor</span>(<span style=color:#a6e22e>end</span>($data), $sorting)
</span></span><span style=display:flex><span>            <span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $previousCursor <span style=color:#f92672>=</span> $hasPreviousPage <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($data)
</span></span><span style=display:flex><span>            <span style=color:#f92672>?</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>generateCursor</span>(<span style=color:#a6e22e>reset</span>($data), $sorting)
</span></span><span style=display:flex><span>            <span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> $data,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> $hasNextPage,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> $hasPreviousPage,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>nextCursor</span><span style=color:#f92672>:</span> $nextCursor,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>previousCursor</span><span style=color:#f92672>:</span> $previousCursor
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>applyCursorPagination</span>(<span style=color:#a6e22e>QueryBuilder</span> $queryBuilder, <span style=color:#a6e22e>CursorPaginationRequest</span> $pagination)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursor</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            $cursorData <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>decodeCursor</span>($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursor</span>);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Apply cursor conditions based on sorting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($cursorData[<span style=color:#e6db74>&#39;creation_date&#39;</span>])) {
</span></span><span style=display:flex><span>                $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;creation_date &gt; :cursor_date&#39;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;cursor_date&#39;</span>, $cursorData[<span style=color:#e6db74>&#39;creation_date&#39;</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($cursorData[<span style=color:#e6db74>&#39;id&#39;</span>])) {
</span></span><span style=display:flex><span>                $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;id &gt; :cursor_id&#39;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;cursor_id&#39;</span>, $cursorData[<span style=color:#e6db74>&#39;id&#39;</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Limit results
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setMaxResults</span>($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>generateCursor</span>(<span style=color:#66d9ef>array</span> $entity, <span style=color:#66d9ef>array</span> $sorting)<span style=color:#f92672>:</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Cursor</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $cursorData <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> $entity[<span style=color:#e6db74>&#39;id&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;creation_date&#39;</span> <span style=color:#f92672>=&gt;</span> $entity[<span style=color:#e6db74>&#39;creation_date&#39;</span>]
</span></span><span style=display:flex><span>        ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#a6e22e>base64_encode</span>(<span style=color:#a6e22e>json_encode</span>($cursorData)));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>decodeCursor</span>(<span style=color:#a6e22e>Cursor</span> $cursor)<span style=color:#f92672>:</span> <span style=color:#66d9ef>array</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $decoded <span style=color:#f92672>=</span> <span style=color:#a6e22e>base64_decode</span>($cursor<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>json_decode</span>($decoded, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=-optimisation-des-performances>âš¡ Optimisation des Performances <a href=#-optimisation-des-performances class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=optimisation-des-requÃªtes>Optimisation des RequÃªtes <a href=#optimisation-des-requ%c3%aates class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Optimisation des RequÃªtes (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OptimizedPaymentRepository</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Connection</span> $connection,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaymentHydrator</span> $hydrator
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>findPaginated</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $pagination,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Use prepared statements for better performance
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $queryBuilder <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>connection</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createQueryBuilder</span>()
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>select</span>(<span style=color:#e6db74>&#39;p.*&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;payments&#39;</span>, <span style=color:#e6db74>&#39;p&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>leftJoin</span>(<span style=color:#e6db74>&#39;p&#39;</span>, <span style=color:#e6db74>&#39;organizations&#39;</span>, <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;p.organization_id = o.id&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>leftJoin</span>(<span style=color:#e6db74>&#39;p&#39;</span>, <span style=color:#e6db74>&#39;subscriptions&#39;</span>, <span style=color:#e6db74>&#39;s&#39;</span>, <span style=color:#e6db74>&#39;p.subscription_id = s.id&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply filters with indexes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyOptimizedFilters</span>($queryBuilder, $filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply sorting with proper indexes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyOptimizedSorting</span>($queryBuilder, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Get total count efficiently
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $totalItems <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getOptimizedTotalCount</span>($filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Apply pagination
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $offset <span style=color:#f92672>=</span> ($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>;
</span></span><span style=display:flex><span>        $queryBuilder
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setFirstResult</span>($offset)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setMaxResults</span>($pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Execute query with profiling
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $startTime <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>        $executionTime <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>) <span style=color:#f92672>-</span> $startTime;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Log performance metrics
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> ($executionTime <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1.0</span>) {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>warning</span>(<span style=color:#e6db74>&#39;Slow query detected&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;execution_time&#39;</span> <span style=color:#f92672>=&gt;</span> $executionTime,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;query&#39;</span> <span style=color:#f92672>=&gt;</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getSQL</span>(),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;parameters&#39;</span> <span style=color:#f92672>=&gt;</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getParameters</span>()
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $rows <span style=color:#f92672>=</span> $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetchAllAssociative</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Hydrate entities efficiently
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $data <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrateEntities</span>($rows);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Calculate pagination metadata
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $totalPages <span style=color:#f92672>=</span> (<span style=color:#a6e22e>int</span>) <span style=color:#a6e22e>ceil</span>($totalItems <span style=color:#f92672>/</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>        $hasNextPage <span style=color:#f92672>=</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>&lt;</span> $totalPages;
</span></span><span style=display:flex><span>        $hasPreviousPage <span style=color:#f92672>=</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> $data,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> $pagination<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalItems</span><span style=color:#f92672>:</span> $totalItems,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalPages</span><span style=color:#f92672>:</span> $totalPages,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> $hasNextPage,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> $hasPreviousPage
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>applyOptimizedFilters</span>(<span style=color:#a6e22e>QueryBuilder</span> $queryBuilder, <span style=color:#66d9ef>array</span> $filters)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Use indexed columns for filtering
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;status&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;p.status = :status&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;status&#39;</span>, $filters[<span style=color:#e6db74>&#39;status&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;organization_id&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;p.organization_id = :organization_id&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;organization_id&#39;</span>, $filters[<span style=color:#e6db74>&#39;organization_id&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;date_from&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;p.creation_date &gt;= :date_from&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;date_from&#39;</span>, $filters[<span style=color:#e6db74>&#39;date_from&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;date_to&#39;</span>])) {
</span></span><span style=display:flex><span>            $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;p.creation_date &lt;= :date_to&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;date_to&#39;</span>, $filters[<span style=color:#e6db74>&#39;date_to&#39;</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Use range queries for better performance
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;amount_min&#39;</span>]) <span style=color:#f92672>||</span> <span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;amount_max&#39;</span>])) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;amount_min&#39;</span>])) {
</span></span><span style=display:flex><span>                $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;p.total_amount &gt;= :amount_min&#39;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;amount_min&#39;</span>, $filters[<span style=color:#e6db74>&#39;amount_min&#39;</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($filters[<span style=color:#e6db74>&#39;amount_max&#39;</span>])) {
</span></span><span style=display:flex><span>                $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>andWhere</span>(<span style=color:#e6db74>&#39;p.total_amount &lt;= :amount_max&#39;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setParameter</span>(<span style=color:#e6db74>&#39;amount_max&#39;</span>, $filters[<span style=color:#e6db74>&#39;amount_max&#39;</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>applyOptimizedSorting</span>(<span style=color:#a6e22e>QueryBuilder</span> $queryBuilder, <span style=color:#66d9ef>array</span> $sorting)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Use composite indexes for sorting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $defaultSorting <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;p.creation_date&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;DESC&#39;</span>, <span style=color:#e6db74>&#39;p.id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;ASC&#39;</span>];
</span></span><span style=display:flex><span>        $appliedSorting <span style=color:#f92672>=</span> $sorting <span style=color:#f92672>?:</span> $defaultSorting;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($appliedSorting <span style=color:#66d9ef>as</span> $field <span style=color:#f92672>=&gt;</span> $direction) {
</span></span><span style=display:flex><span>            $allowedFields <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;p.creation_date&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;creation_date&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;p.total_amount&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;total_amount&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;p.status&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;status&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;p.customer_name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;customer_name&#39;</span>
</span></span><span style=display:flex><span>            ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($allowedFields[$field])) {
</span></span><span style=display:flex><span>                $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addOrderBy</span>($field, <span style=color:#a6e22e>strtoupper</span>($direction));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getOptimizedTotalCount</span>(<span style=color:#66d9ef>array</span> $filters)<span style=color:#f92672>:</span> <span style=color:#a6e22e>int</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Use COUNT(*) with proper indexes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $queryBuilder <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>connection</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createQueryBuilder</span>()
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>select</span>(<span style=color:#e6db74>&#39;COUNT(*)&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;payments&#39;</span>, <span style=color:#e6db74>&#39;p&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>applyOptimizedFilters</span>($queryBuilder, $filters);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>int</span>) $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetchOne</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>hydrateEntities</span>(<span style=color:#66d9ef>array</span> $rows)<span style=color:#f92672>:</span> <span style=color:#66d9ef>array</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Batch hydrate for better performance
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>array_map</span>(<span style=color:#a6e22e>fn</span>($row) <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrator</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrate</span>($row), $rows);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=cache-de-pagination>Cache de Pagination <a href=#cache-de-pagination class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Cache de Pagination (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CachedPaginationService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span> $repository,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CacheInterface</span> $cache,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>paginate</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $request,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span> {
</span></span><span style=display:flex><span>        $cacheKey <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>generateCacheKey</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Try to get from cache
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $cachedResponse <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cache</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>get</span>($cacheKey);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($cachedResponse <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Pagination data retrieved from cache&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;cache_key&#39;</span> <span style=color:#f92672>=&gt;</span> $cacheKey
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> $cachedResponse;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Get from repository
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>findPaginated</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Cache the response
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cache</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>set</span>($cacheKey, $response, <span style=color:#ae81ff>300</span>); <span style=color:#75715e>// 5 minutes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Pagination data cached&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;cache_key&#39;</span> <span style=color:#f92672>=&gt;</span> $cacheKey,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;ttl&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>generateCacheKey</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $request,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>        $keyData <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;filters&#39;</span> <span style=color:#f92672>=&gt;</span> $filters,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;sorting&#39;</span> <span style=color:#f92672>=&gt;</span> $sorting
</span></span><span style=display:flex><span>        ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;pagination:&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>md5</span>(<span style=color:#a6e22e>serialize</span>($keyData));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=-tests-de-pagination>ğŸ§ª Tests de Pagination <a href=#-tests-de-pagination class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=test-de-pagination-par-offset>Test de Pagination par Offset <a href=#test-de-pagination-par-offset class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Test de Pagination par Offset (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OffsetPaginationServiceTest</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>TestCase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>OffsetPaginationService</span> $service;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span> $repository;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setUp</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>PaginatedRepositoryInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>OffsetPaginationService</span>(
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span>,
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>LoggerInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldPaginateFirstPage</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $request <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationRequest</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>        $expectedResponse <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Payment 1&#39;</span>]],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalItems</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>25</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalPages</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;findPaginated&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>($request, [], [])
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>willReturn</span>($expectedResponse);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>paginate</span>($request);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>1</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>10</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>25</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalItems</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>3</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalPages</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertFalse</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldPaginateWithFilters</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $request <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationRequest</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>        $filters <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;status&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;completed&#39;</span>];
</span></span><span style=display:flex><span>        $sorting <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;creation_date&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;DESC&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $expectedResponse <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Payment 1&#39;</span>]],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalItems</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>15</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalPages</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;findPaginated&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>($request, $filters, $sorting)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>willReturn</span>($expectedResponse);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>paginate</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>15</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalItems</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>2</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalPages</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=test-de-pagination-par-curseur>Test de Pagination par Curseur <a href=#test-de-pagination-par-curseur class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Test de Pagination par Curseur (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CursorPaginationServiceTest</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>TestCase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CursorPaginationService</span> $service;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span> $repository;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setUp</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationService</span>(
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span>,
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>LoggerInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldPaginateWithCursor</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $cursor <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MSwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDEgMTA6MDA6MDAifQ==&#39;</span>);
</span></span><span style=display:flex><span>        $request <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationRequest</span>(<span style=color:#ae81ff>10</span>, $cursor);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $expectedResponse <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Payment 2&#39;</span>]],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>nextCursor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MiwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDIgMTA6MDA6MDAifQ==&#39;</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>previousCursor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MSwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDEgMTA6MDA6MDAifQ==&#39;</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;findCursorPaginated&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>($request, [], [])
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>willReturn</span>($expectedResponse);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>paginate</span>($request);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>10</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertNotNull</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>nextCursor</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertNotNull</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>previousCursor</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldPaginateFirstPageWithoutCursor</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $request <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationRequest</span>(<span style=color:#ae81ff>10</span>, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $expectedResponse <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Payment 1&#39;</span>]],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>nextCursor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MSwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDEgMTA6MDA6MDAifQ==&#39;</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>previousCursor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;findCursorPaginated&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>($request, [], [])
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>willReturn</span>($expectedResponse);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>paginate</span>($request);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertFalse</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertNotNull</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>nextCursor</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertNull</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>previousCursor</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=-bonnes-pratiques-du-projet-gyroscops-cloud>ğŸ—ï¸ Bonnes Pratiques du Projet Gyroscops Cloud <a href=#-bonnes-pratiques-du-projet-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=pagination-selon-hive037-et-hive039>Pagination selon HIVE037 et HIVE039 <a href=#pagination-selon-hive037-et-hive039 class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Le Gyroscops Cloud implÃ©mente une pagination robuste selon les ADR HIVE037 et HIVE039 :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Pagination Gyroscops Cloud (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HivePaginationService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span> $repository,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span> $cursorRepository,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>MetricsCollector</span> $metrics
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>paginateWithOffset</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaginationRequest</span> $request,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span> {
</span></span><span style=display:flex><span>        $startTime <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Starting offset pagination&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;filters&#39;</span> <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sanitizeFilters</span>($filters),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;sorting&#39;</span> <span style=color:#f92672>=&gt;</span> $sorting
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>findPaginated</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $duration <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>) <span style=color:#f92672>-</span> $startTime;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>observeHistogram</span>(<span style=color:#e6db74>&#39;pagination_duration_seconds&#39;</span>, $duration, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;offset&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Offset pagination completed&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;duration&#39;</span> <span style=color:#f92672>=&gt;</span> $duration,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;total_items&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalItems</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;total_pages&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalPages</span>()
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>paginateWithCursor</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CursorPaginationRequest</span> $request,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>CursorPaginationResponse</span> {
</span></span><span style=display:flex><span>        $startTime <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Starting cursor pagination&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;cursor&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursor</span><span style=color:#f92672>?-&gt;</span><span style=color:#a6e22e>toString</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;filters&#39;</span> <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sanitizeFilters</span>($filters),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;sorting&#39;</span> <span style=color:#f92672>=&gt;</span> $sorting
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursorRepository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>findCursorPaginated</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $duration <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>) <span style=color:#f92672>-</span> $startTime;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>observeHistogram</span>(<span style=color:#e6db74>&#39;pagination_duration_seconds&#39;</span>, $duration, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;cursor&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Cursor pagination completed&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;duration&#39;</span> <span style=color:#f92672>=&gt;</span> $duration,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;has_next_page&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;has_previous_page&#39;</span> <span style=color:#f92672>=&gt;</span> $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>()
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sanitizeFilters</span>(<span style=color:#66d9ef>array</span> $filters)<span style=color:#f92672>:</span> <span style=color:#66d9ef>array</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $sensitiveFields <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;password&#39;</span>, <span style=color:#e6db74>&#39;token&#39;</span>, <span style=color:#e6db74>&#39;secret&#39;</span>, <span style=color:#e6db74>&#39;key&#39;</span>];
</span></span><span style=display:flex><span>        $sanitized <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($filters <span style=color:#66d9ef>as</span> $key <span style=color:#f92672>=&gt;</span> $value) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>(<span style=color:#a6e22e>strtolower</span>($key), $sensitiveFields)) {
</span></span><span style=display:flex><span>                $sanitized[$key] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;[REDACTED]&#39;</span>;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                $sanitized[$key] <span style=color:#f92672>=</span> $value;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $sanitized;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=optimisation-des-requÃªtes-selon-hive035>Optimisation des RequÃªtes selon HIVE035 <a href=#optimisation-des-requ%c3%aates-selon-hive035 class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Le Gyroscops Cloud optimise les requÃªtes avec un logging dÃ©taillÃ© selon l&rsquo;ADR HIVE035 :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Optimisation des RequÃªtes Gyroscops Cloud (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HiveQueryOptimizer</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Connection</span> $connection,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>MetricsCollector</span> $metrics
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>executeOptimizedQuery</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>QueryBuilder</span> $queryBuilder,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>string</span> $operationName,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $context <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#66d9ef>array</span> {
</span></span><span style=display:flex><span>        $startTime <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        $query <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getSQL</span>();
</span></span><span style=display:flex><span>        $parameters <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getParameters</span>();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Executing optimized query&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;operation&#39;</span> <span style=color:#f92672>=&gt;</span> $operationName,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;query&#39;</span> <span style=color:#f92672>=&gt;</span> $query,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;parameters&#39;</span> <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sanitizeParameters</span>($parameters),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;context&#39;</span> <span style=color:#f92672>=&gt;</span> $context
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            $result <span style=color:#f92672>=</span> $queryBuilder<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>            $rows <span style=color:#f92672>=</span> $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetchAllAssociative</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            $duration <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>) <span style=color:#f92672>-</span> $startTime;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>observeHistogram</span>(<span style=color:#e6db74>&#39;query_duration_seconds&#39;</span>, $duration, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;operation&#39;</span> <span style=color:#f92672>=&gt;</span> $operationName,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;row_count&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>count</span>($rows)
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Query executed successfully&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;operation&#39;</span> <span style=color:#f92672>=&gt;</span> $operationName,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;duration&#39;</span> <span style=color:#f92672>=&gt;</span> $duration,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;row_count&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>count</span>($rows)
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> $rows;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>\Throwable</span> $e) {
</span></span><span style=display:flex><span>            $duration <span style=color:#f92672>=</span> <span style=color:#a6e22e>microtime</span>(<span style=color:#66d9ef>true</span>) <span style=color:#f92672>-</span> $startTime;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>incrementCounter</span>(<span style=color:#e6db74>&#39;query_errors_total&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;operation&#39;</span> <span style=color:#f92672>=&gt;</span> $operationName,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;error_type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>get_class</span>($e)
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Query execution failed&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;operation&#39;</span> <span style=color:#f92672>=&gt;</span> $operationName,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;query&#39;</span> <span style=color:#f92672>=&gt;</span> $query,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;parameters&#39;</span> <span style=color:#f92672>=&gt;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sanitizeParameters</span>($parameters),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;error&#39;</span> <span style=color:#f92672>=&gt;</span> $e<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getMessage</span>(),
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;duration&#39;</span> <span style=color:#f92672>=&gt;</span> $duration
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> $e;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sanitizeParameters</span>(<span style=color:#66d9ef>array</span> $parameters)<span style=color:#f92672>:</span> <span style=color:#66d9ef>array</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $sensitiveFields <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;password&#39;</span>, <span style=color:#e6db74>&#39;token&#39;</span>, <span style=color:#e6db74>&#39;secret&#39;</span>, <span style=color:#e6db74>&#39;key&#39;</span>];
</span></span><span style=display:flex><span>        $sanitized <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($parameters <span style=color:#66d9ef>as</span> $key <span style=color:#f92672>=&gt;</span> $value) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>(<span style=color:#a6e22e>strtolower</span>($key), $sensitiveFields)) {
</span></span><span style=display:flex><span>                $sanitized[$key] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;[REDACTED]&#39;</span>;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                $sanitized[$key] <span style=color:#f92672>=</span> $value;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $sanitized;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=cache-de-pagination-selon-hive013>Cache de Pagination selon HIVE013 <a href=#cache-de-pagination-selon-hive013 class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Le Gyroscops Cloud implÃ©mente un cache intelligent pour la pagination selon l&rsquo;ADR HIVE013 :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Cache de Pagination Gyroscops Cloud (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HivePaginationCache</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CacheInterface</span> $cache,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>MetricsCollector</span> $metrics
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getCachedPagination</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>string</span> $cacheKey,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>callable</span> $paginationCallback,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>int</span> $ttl <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>PaginationResponse</span> {
</span></span><span style=display:flex><span>        $cached <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cache</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>get</span>($cacheKey);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($cached <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>incrementCounter</span>(<span style=color:#e6db74>&#39;pagination_cache_hits_total&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;offset&#39;</span>
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Pagination data retrieved from cache&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;cache_key&#39;</span> <span style=color:#f92672>=&gt;</span> $cacheKey
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> $cached;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>incrementCounter</span>(<span style=color:#e6db74>&#39;pagination_cache_misses_total&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;offset&#39;</span>
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $response <span style=color:#f92672>=</span> $paginationCallback();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cache</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>set</span>($cacheKey, $response, $ttl);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Pagination data cached&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;cache_key&#39;</span> <span style=color:#f92672>=&gt;</span> $cacheKey,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;ttl&#39;</span> <span style=color:#f92672>=&gt;</span> $ttl
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getCachedCursorPagination</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>string</span> $cacheKey,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>callable</span> $paginationCallback,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>int</span> $ttl <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>CursorPaginationResponse</span> {
</span></span><span style=display:flex><span>        $cached <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cache</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>get</span>($cacheKey);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($cached <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>incrementCounter</span>(<span style=color:#e6db74>&#39;pagination_cache_hits_total&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;cursor&#39;</span>
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Cursor pagination data retrieved from cache&#39;</span>, [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;cache_key&#39;</span> <span style=color:#f92672>=&gt;</span> $cacheKey
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> $cached;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>incrementCounter</span>(<span style=color:#e6db74>&#39;pagination_cache_misses_total&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;cursor&#39;</span>
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $response <span style=color:#f92672>=</span> $paginationCallback();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cache</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>set</span>($cacheKey, $response, $ttl);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;Cursor pagination data cached&#39;</span>, [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;cache_key&#39;</span> <span style=color:#f92672>=&gt;</span> $cacheKey,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;ttl&#39;</span> <span style=color:#f92672>=&gt;</span> $ttl
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $response;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>generateCacheKey</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>string</span> $operation,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $filters,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>array</span> $sorting,
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span><span style=color:#a6e22e>int</span> $page <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span><span style=color:#a6e22e>int</span> $pageSize <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span><span style=color:#a6e22e>string</span> $cursor <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>        $keyData <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;operation&#39;</span> <span style=color:#f92672>=&gt;</span> $operation,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;filters&#39;</span> <span style=color:#f92672>=&gt;</span> $filters,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;sorting&#39;</span> <span style=color:#f92672>=&gt;</span> $sorting,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page&#39;</span> <span style=color:#f92672>=&gt;</span> $page,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> $pageSize,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;cursor&#39;</span> <span style=color:#f92672>=&gt;</span> $cursor
</span></span><span style=display:flex><span>        ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;pagination:&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>md5</span>(<span style=color:#a6e22e>serialize</span>($keyData));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=tests-de-pagination-selon-hive027>Tests de Pagination selon HIVE027 <a href=#tests-de-pagination-selon-hive027 class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Le Gyroscops Cloud teste la pagination selon les standards HIVE027 :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// âœ… Tests de Pagination Gyroscops Cloud (Projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HivePaginationServiceTest</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>TestCase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>HivePaginationService</span> $service;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>PaginatedRepositoryInterface</span> $repository;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span> $cursorRepository;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>LoggerInterface</span> $logger;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>MetricsCollector</span> $metrics;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setUp</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>PaginatedRepositoryInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursorRepository</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>CursorPaginatedRepositoryInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>LoggerInterface</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createMock</span>(<span style=color:#a6e22e>MetricsCollector</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>HivePaginationService</span>(
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span>,
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursorRepository</span>,
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span>,
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldPaginateWithOffset</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $request <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationRequest</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>        $filters <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;status&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;completed&#39;</span>];
</span></span><span style=display:flex><span>        $sorting <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;creation_date&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;DESC&#39;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $expectedResponse <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Payment 1&#39;</span>]],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalItems</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>25</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>totalPages</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>repository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;findPaginated&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>($request, $filters, $sorting)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>willReturn</span>($expectedResponse);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>exactly</span>(<span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;info&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>withConsecutive</span>(
</span></span><span style=display:flex><span>                [<span style=color:#e6db74>&#39;Starting offset pagination&#39;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isType</span>(<span style=color:#e6db74>&#39;array&#39;</span>)],
</span></span><span style=display:flex><span>                [<span style=color:#e6db74>&#39;Offset pagination completed&#39;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isType</span>(<span style=color:#e6db74>&#39;array&#39;</span>)]
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;observeHistogram&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>(<span style=color:#e6db74>&#39;pagination_duration_seconds&#39;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isType</span>(<span style=color:#e6db74>&#39;float&#39;</span>), [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;offset&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>paginateWithOffset</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>1</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>page</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>10</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>25</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalItems</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>3</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getTotalPages</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldPaginateWithCursor</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $cursor <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MSwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDEgMTA6MDA6MDAifQ==&#39;</span>);
</span></span><span style=display:flex><span>        $request <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationRequest</span>(<span style=color:#ae81ff>10</span>, $cursor);
</span></span><span style=display:flex><span>        $filters <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;status&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;completed&#39;</span>];
</span></span><span style=display:flex><span>        $sorting <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;creation_date&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;DESC&#39;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $expectedResponse <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CursorPaginationResponse</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Payment 2&#39;</span>]],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pageSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasNextPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>hasPreviousPage</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>nextCursor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MiwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDIgMTA6MDA6MDAifQ==&#39;</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>previousCursor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cursor</span>(<span style=color:#e6db74>&#39;eyJpZCI6MSwiY3JlYXRpb25fZGF0ZSI6IjIwMjQtMDEtMDEgMTA6MDA6MDAifQ==&#39;</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cursorRepository</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;findCursorPaginated&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>($request, $filters, $sorting)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>willReturn</span>($expectedResponse);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>logger</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>exactly</span>(<span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;info&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>withConsecutive</span>(
</span></span><span style=display:flex><span>                [<span style=color:#e6db74>&#39;Starting cursor pagination&#39;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isType</span>(<span style=color:#e6db74>&#39;array&#39;</span>)],
</span></span><span style=display:flex><span>                [<span style=color:#e6db74>&#39;Cursor pagination completed&#39;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isType</span>(<span style=color:#e6db74>&#39;array&#39;</span>)]
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>metrics</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expects</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>once</span>())
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>(<span style=color:#e6db74>&#39;observeHistogram&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>with</span>(<span style=color:#e6db74>&#39;pagination_duration_seconds&#39;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isType</span>(<span style=color:#e6db74>&#39;float&#39;</span>), [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;cursor&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;page_size&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>            ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Act
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>paginateWithCursor</span>($request, $filters, $sorting);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Assert
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#ae81ff>10</span>, $response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>pageSize</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasNextPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasPreviousPage</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertNotNull</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>nextCursor</span>);
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertNotNull</span>($response<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>previousCursor</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><div class=chapter-navigation><h2 class=chapter-nav-title>ğŸ¯ Votre Prochaine Ã‰tape</h2><p class=chapter-nav-subtitle>Maintenant que vous comprenez les concepts de base et que j'ai partagÃ© mon expÃ©rience avec Gyroscops, quel est votre contexte ?</p><div class=chapter-options><div class=chapter-option data-color=green><div class=chapter-option-header><div class=chapter-option-letter>A</div><div><h3 class=chapter-option-title>Je veux explorer la gestion d'erreurs et l'observabilitÃ©</h3><p class=chapter-option-subtitle>Vous voulez amÃ©liorer la robustesse de votre application</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>CritÃ¨res d'adoption :</h4><ul class=chapter-option-criteria-list><li>Besoin de robustesse</li><li>Gestion d'erreurs complexe</li><li>ObservabilitÃ© importante</li><li>Monitoring et logging</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>â±ï¸ 30-40 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Gestion d'Erreurs et ObservabilitÃ©
<span class=coming-soon-indicator>ğŸš§</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=yellow><div class=chapter-option-header><div class=chapter-option-letter>B</div><div><h3 class=chapter-option-title>Je veux explorer les tests et la qualitÃ©</h3><p class=chapter-option-subtitle>Vous voulez amÃ©liorer la qualitÃ© de votre code</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>CritÃ¨res d'adoption :</h4><ul class=chapter-option-criteria-list><li>Besoin de qualitÃ© de code</li><li>Tests complets</li><li>Couverture de code</li><li>Standards de qualitÃ©</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>â±ï¸ 35-45 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Tests et QualitÃ©
<span class=coming-soon-indicator>ğŸš§</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=red><div class=chapter-option-header><div class=chapter-option-letter>C</div><div><h3 class=chapter-option-title>Je veux explorer la sÃ©curitÃ© et l'autorisation</h3><p class=chapter-option-subtitle>Vous voulez sÃ©curiser votre application</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>CritÃ¨res d'adoption :</h4><ul class=chapter-option-criteria-list><li>Besoin de sÃ©curitÃ©</li><li>Gestion des permissions</li><li>Authentification</li><li>Autorisation fine</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>â±ï¸ 40-50 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">SÃ©curitÃ© et Autorisation
<span class=coming-soon-indicator>ğŸš§</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=blue><div class=chapter-option-header><div class=chapter-option-letter>D</div><div><h3 class=chapter-option-title>Je veux continuer avec la pagination</h3><p class=chapter-option-subtitle>La pagination me convient parfaitement</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>CritÃ¨res d'adoption :</h4><ul class=chapter-option-criteria-list><li>Application simple</li><li>Pagination basique</li><li>Performance acceptable</li><li>Pas de besoins complexes</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>â±ï¸ 25-35 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Frontend et IntÃ©gration
<span class=coming-soon-indicator>ğŸš§</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style></div></div><style>.chapter-navigation{margin:2rem 0;padding:1.5rem;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);border-radius:12px;border-left:4px solid #3b82f6}.chapter-nav-title{margin:0 0 .5rem;font-size:1.5rem;font-weight:700;color:#1e293b}.chapter-nav-subtitle{margin:0 0 1.5rem;color:#64748b;font-size:1rem;line-height:1.6}.chapter-options{display:flex;flex-direction:column;gap:1rem}.chapter-option{background:#fff;border-radius:8px;padding:1.25rem;border:1px solid #e2e8f0;transition:all .2s ease;position:relative;overflow:hidden}.chapter-option:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.1);border-color:#3b82f6}.chapter-option::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--option-color,#6b7280);border-radius:0 2px 2px 0}.chapter-option-header{display:flex;align-items:center;margin-bottom:.75rem}.chapter-option-letter{display:inline-flex;align-items:center;justify-content:center;width:2rem;height:2rem;border-radius:50%;background:var(--option-color,#6b7280);color:#fff;font-weight:700;font-size:.875rem;margin-right:.75rem;flex-shrink:0}.chapter-option-title{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0;line-height:1.4}.chapter-option-subtitle{font-size:.875rem;color:#64748b;font-style:italic;margin:.25rem 0 0;line-height:1.4}.chapter-option-content{margin-left:2.75rem}.chapter-option-criteria{margin-bottom:.75rem}.chapter-option-criteria-title{font-size:.875rem;font-weight:600;color:#374151;margin:0 0 .5rem}.chapter-option-criteria-list{list-style:none;padding:0;margin:0}.chapter-option-criteria-list li{position:relative;padding-left:1.25rem;margin-bottom:.25rem;font-size:.875rem;color:#4b5563;line-height:1.4}.chapter-option-criteria-list li::before{content:'âœ“';position:absolute;left:0;color:#10b981;font-weight:600}.chapter-option-footer{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;padding-top:.75rem;border-top:1px solid #e5e7eb}.chapter-option-time{font-size:.875rem;color:#6b7280;font-weight:500}.chapter-option-link{display:inline-flex;align-items:center;padding:.5rem 1rem;background:var(--option-color,#6b7280);color:#fff!important;text-decoration:none!important;border-radius:6px;font-weight:600;font-size:.875rem;transition:all .2s ease;border:none;cursor:pointer}.chapter-option-link:hover{background:var(--option-color-dark,#4b5563);color:#fff!important;text-decoration:none!important;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.15)}.chapter-option-link:visited{color:#fff!important;text-decoration:none!important}.chapter-option-link:focus{color:#fff!important;text-decoration:none!important;outline:2px solid rgba(255,255,255,.5);outline-offset:2px}.chapter-option-link:active{color:#fff!important;text-decoration:none!important}.chapter-option-link::after{content:'â†’';margin-left:.5rem;transition:transform .2s ease;color:#fff!important}.chapter-option-link:hover::after{transform:translateX(2px);color:#fff!important}.chapter-navigation a{color:inherit;text-decoration:none}.chapter-navigation a:hover{color:inherit;text-decoration:none}.chapter-navigation a:visited{color:inherit;text-decoration:none}.chapter-navigation a:focus{color:inherit;text-decoration:none}.chapter-navigation a:active{color:inherit;text-decoration:none}.chapter-option[data-color=green]{--option-color:#10b981;--option-color-dark:#059669}.chapter-option[data-color=yellow]{--option-color:#f59e0b;--option-color-dark:#d97706}.chapter-option[data-color=red]{--option-color:#ef4444;--option-color-dark:#dc2626}.chapter-option[data-color=blue]{--option-color:#3b82f6;--option-color-dark:#2563eb}.chapter-option[data-color=purple]{--option-color:#8b5cf6;--option-color-dark:#7c3aed}.chapter-option[data-color=orange]{--option-color:#f97316;--option-color-dark:#ea580c}.chapter-option[data-color=teal]{--option-color:#14b8a6;--option-color-dark:#0d9488}.chapter-option[data-color=indigo]{--option-color:#6366f1;--option-color-dark:#4f46e5}.chapter-option[data-color=pink]{--option-color:#ec4899;--option-color-dark:#db2777}.chapter-option[data-color=cyan]{--option-color:#06b6d4;--option-color-dark:#0891b2}@media(max-width:768px){.chapter-navigation{padding:1rem}.chapter-option{padding:1rem}.chapter-option-content{margin-left:2.5rem}.chapter-option-footer{flex-direction:column;align-items:flex-start;gap:.75rem}.chapter-option-link{align-self:stretch;justify-content:center}}</style></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/chapitres/stockage/sql/chapitre-20-stockage-sql-event-sourcing-cqs/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Chapitre 58 : Stockage SQL - Event Sourcing + CQS</p></div></div></a></div><div class="col-sm-6 pt-2 doc-prev"><a class=ms-auto href=/chapitres/stockage/sql/chapitre-21-stockage-sql-event-sourcing-cqrs/><div class="card h-100 my-1 text-end"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0">Chapitre 59 : Stockage SQL - Event Sourcing + CQRS <i class="material-icons align-middle">navigate_next</i></p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>Â© 2025 GrÃ©gory Planchat. Tous droits rÃ©servÃ©s.</p></div></div></div><div class="row mt-3 pt-3 border-top"><div class=col-12><div class=text-center><h6 class="text-muted mb-2">Nos Sponsors</h6><p class="text-muted small mb-2">Merci Ã  nos partenaires qui soutiennent cette initiative</p><div class="d-flex justify-content-center align-items-center flex-wrap gap-3"><div class=sponsor-item><a href=https://kiboko.fr target=_blank rel="noopener noreferrer" class="text-decoration-none d-inline-block"><img src=/logo-kiboko-fr.svg alt=Kiboko width=120 height=60 style=display:block;max-width:120px;height:auto></a></div><div class=sponsor-item><a href=https://gyroscops.com target=_blank rel="noopener noreferrer" class="text-decoration-none d-inline-block"><img src=/logo-gyroscops.svg alt=Gyroscops width=120 height=60 style=display:block;max-width:120px;height:auto></a></div></div></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script src=/docs/js/bootstrap.js defer></script><script type=text/javascript src=http://localhost:1313/docs/js/bundle.js defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    


    

    

    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>