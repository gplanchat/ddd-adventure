<!doctype html><html lang=fr-fr><head><meta charset=utf-8><title>Chapitre 4 : L'Example Mapping - Détailer les Règles Métier | DDD Adventure</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Maîtriser l'Example Mapping pour détailler les règles métier complexes découvertes lors de l'Event Storming"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=http://localhost:1313/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=http://localhost:1313/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=http://localhost:1313/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=http://localhost:1313/site.webmanifest><meta property="og:title" content="Chapitre 4 : L'Example Mapping - Détailer les Règles Métier"><meta property="og:description" content="Maîtriser l'Example Mapping pour détailler les règles métier complexes découvertes lors de l'Event Storming"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/chapitres/fondamentaux/chapitre-04-example-mapping/"><meta property="og:image" content="http://localhost:1313/opengraph/card-base-2_hu_c44407f6d967cf5d.png"><meta property="article:section" content="chapitres"><meta property="article:published_time" content="2024-12-19T00:00:00+00:00"><meta property="article:modified_time" content="2024-12-19T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/opengraph/card-base-2_hu_c44407f6d967cf5d.png"><meta name=twitter:title content="Chapitre 4 : L'Example Mapping - Détailer les Règles Métier"><meta name=twitter:description content="Maîtriser l'Example Mapping pour détailler les règles métier complexes découvertes lors de l'Event Storming"><link rel=alternate type=application/atom+xml title="Atom feed for DDD Adventure" href=/index.xml><script type=text/javascript src=http://localhost:1313/docs/js/flexsearch.bundle.min.f5159d5a2151ffbb653996ec17eaff7da4e04c286bd879fc41839d36a5586f3f20eaead0b6089de48f9adc669cdee771.js integrity=sha384-9RWdWiFR/7tlOZbsF+r/faTgTChr2Hn8QYOdNqVYbz8g6urQtgid5I+a3Gac3udx crossorigin=anonymous></script><link rel=stylesheet href=/docs/scss/style.min.3377194a2707d3dadf7a16321e3f45dec030951decd2b724d6e046d8a72467cab3654273b75f2768a9a72140ee026ecf.css integrity=sha384-M3cZSicH09rfehYyHj9F3sAwlR3s0rck1uBG2KckZ8qzZUJzt18naKmnIUDuAm7P crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li class="sidebar-dropdown no-icon current active"><button class=btn>
Chapitres Fondamentaux</button><div class="sidebar-submenu d-block"><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-01-introduction-event-storming-ddd/>Chapitre 1 : Introduction au Domain-Driven Design et Event Storming</a></li><li class="current no-icon"><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-04-example-mapping/>Chapitre 4 : L'Example Mapping - Détailer les Règles Métier</a></li></ul></div></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentColor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentColor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentColor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentColor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentColor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentColor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentColor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"></ul></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/chapitres/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/chapitres/fondamentaux/><span itemprop=name>Chapitres Fondamentaux</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Chapitre 4 : L'Example Mapping - Détailer les Règles Métier</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=TableOfContents><ul><li><a href=#-objectif-de-ce-chapitre>🎯 Objectif de ce Chapitre</a><ul><li><a href=#mon-problème--comment-détailer-les-règles-métier-complexes->Mon Problème : Comment Détailer les Règles Métier Complexes ?</a></li><li><a href=#lexample-mapping--mon-détective-du-métier>L&rsquo;Example Mapping : Mon Détective du Métier</a></li></ul></li><li><a href=#quest-ce-que-lexample-mapping->Qu&rsquo;est-ce que l&rsquo;Example Mapping ?</a><ul><li><a href=#le-concept-fondamental>Le Concept Fondamental</a></li><li><a href=#les-4-types-de-cartes>Les 4 Types de Cartes</a></li></ul></li><li><a href=#pourquoi-lexample-mapping->Pourquoi l&rsquo;Example Mapping ?</a><ul><li><a href=#1-révéler-les-règles-implicites---mon-détective-du-métier>1. <strong>Révéler les Règles Implicites</strong> - Mon Détective du Métier</a></li><li><a href=#2-concrétiser-l---de-lidée-à-la-réalité>2. <strong>Concrétiser l’Abstrait</strong> - De l’Idée à la Réalité</a></li><li><a href=#3-faciliter-les-tests---de-lexemple-au-code>3. <strong>Faciliter les Tests</strong> - De l’Exemple au Code</a></li></ul></li><li><a href=#exemple-dexample-mapping--traitement-dun-paiement>Exemple d&rsquo;Example Mapping : Traitement d&rsquo;un Paiement</a><ul><li><a href=#-règles-métier-post-it-jaunes>🟡 <strong>Règles Métier (Post-it Jaunes)</strong></a></li><li><a href=#-exemples-concrets-post-it-verts>🟢 <strong>Exemples Concrets (Post-it Verts)</strong></a></li><li><a href=#-questions-à-explorer-post-it-rouges>🔴 <strong>Questions à Explorer (Post-it Rouges)</strong></a></li><li><a href=#-scénario-d>🔵 <strong>Scénario d’Usage (Post-it Bleu)</strong></a></li></ul></li><li><a href=#comment-utiliser-lexample-mapping>Comment Utiliser l&rsquo;Example Mapping</a><ul><li><a href=#1-après-l>1. <strong>Après l’Event Storming</strong></a></li><li><a href=#2-en-petite-équipe>2. <strong>En Petite Équipe</strong></a></li><li><a href=#3-durée-limitée>3. <strong>Durée Limitée</strong></a></li><li><a href=#4-focus-sur-les-cas-limites>4. <strong>Focus sur les Cas Limites</strong></a></li></ul></li><li><a href=#exemple-concret--règles-de-paiement>Exemple Concret : Règles de Paiement</a></li><li><a href=#avantages-de-lexample-mapping>Avantages de l&rsquo;Example Mapping</a></li><li><a href=#mon-premier-example-mapping-avec-gyroscops>Mon Premier Example Mapping avec Gyroscops</a><ul><li><a href=#la-préparation>La Préparation</a></li><li><a href=#latelier-en-action>L&rsquo;Atelier en Action</a></li><li><a href=#les-découvertes-surprenantes>Les Découvertes Surprenantes</a></li></ul></li><li><a href=#comment-utiliser-lexample-mapping-1>Comment Utiliser l&rsquo;Example Mapping</a><ul><li><a href=#1-avant-de-commencer-un-projet>1. <strong>Avant de Commencer un Projet</strong></a></li><li><a href=#2-pendant-le-développement>2. <strong>Pendant le Développement</strong></a></li><li><a href=#3-pour-écrire-les-tests>3. <strong>Pour Écrire les Tests</strong></a></li></ul></li><li><a href=#les-pièges-à-éviter>Les Pièges à Éviter</a><ul><li><a href=#1-règles-trop-génériques>1. <strong>Règles Trop Génériques</strong></a></li><li><a href=#2-exemples-trop-abstraits>2. <strong>Exemples Trop Abstraits</strong></a></li><li><a href=#3-questions-non-résolues>3. <strong>Questions Non Résolues</strong></a></li><li><a href=#4-scénarios-incomplets>4. <strong>Scénarios Incomplets</strong></a></li></ul></li><li><a href=#lexample-mapping-et-levent-storming>L&rsquo;Example Mapping et l&rsquo;Event Storming</a><ul><li><a href=#la-synergie>La Synergie</a></li><li><a href=#la-progression-logique>La Progression Logique</a></li></ul></li><li><a href=#-implémentation-concrète-dans-le-projet-gyroscops-cloud>🏗️ Implémentation Concrète dans le projet Gyroscops Cloud</a><ul><li><a href=#example-mapping-appliqué-à-gyroscops-cloud>Example Mapping Appliqué à Gyroscops Cloud</a></li><li><a href=#références-aux-adr-du-projet-gyroscops-cloud>Références aux ADR du projet Gyroscops Cloud</a></li><li><a href=#-option-e--je-veux-comprendre-la-granularité-des-choix-architecturaux>🟣 Option E : Je veux comprendre la granularité des choix architecturaux</a></li></ul></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#-objectif-de-ce-chapitre>🎯 Objectif de ce Chapitre</a><ul><li><a href=#mon-problème--comment-détailer-les-règles-métier-complexes->Mon Problème : Comment Détailer les Règles Métier Complexes ?</a></li><li><a href=#lexample-mapping--mon-détective-du-métier>L&rsquo;Example Mapping : Mon Détective du Métier</a></li></ul></li><li><a href=#quest-ce-que-lexample-mapping->Qu&rsquo;est-ce que l&rsquo;Example Mapping ?</a><ul><li><a href=#le-concept-fondamental>Le Concept Fondamental</a></li><li><a href=#les-4-types-de-cartes>Les 4 Types de Cartes</a></li></ul></li><li><a href=#pourquoi-lexample-mapping->Pourquoi l&rsquo;Example Mapping ?</a><ul><li><a href=#1-révéler-les-règles-implicites---mon-détective-du-métier>1. <strong>Révéler les Règles Implicites</strong> - Mon Détective du Métier</a></li><li><a href=#2-concrétiser-l---de-lidée-à-la-réalité>2. <strong>Concrétiser l’Abstrait</strong> - De l’Idée à la Réalité</a></li><li><a href=#3-faciliter-les-tests---de-lexemple-au-code>3. <strong>Faciliter les Tests</strong> - De l’Exemple au Code</a></li></ul></li><li><a href=#exemple-dexample-mapping--traitement-dun-paiement>Exemple d&rsquo;Example Mapping : Traitement d&rsquo;un Paiement</a><ul><li><a href=#-règles-métier-post-it-jaunes>🟡 <strong>Règles Métier (Post-it Jaunes)</strong></a></li><li><a href=#-exemples-concrets-post-it-verts>🟢 <strong>Exemples Concrets (Post-it Verts)</strong></a></li><li><a href=#-questions-à-explorer-post-it-rouges>🔴 <strong>Questions à Explorer (Post-it Rouges)</strong></a></li><li><a href=#-scénario-d>🔵 <strong>Scénario d’Usage (Post-it Bleu)</strong></a></li></ul></li><li><a href=#comment-utiliser-lexample-mapping>Comment Utiliser l&rsquo;Example Mapping</a><ul><li><a href=#1-après-l>1. <strong>Après l’Event Storming</strong></a></li><li><a href=#2-en-petite-équipe>2. <strong>En Petite Équipe</strong></a></li><li><a href=#3-durée-limitée>3. <strong>Durée Limitée</strong></a></li><li><a href=#4-focus-sur-les-cas-limites>4. <strong>Focus sur les Cas Limites</strong></a></li></ul></li><li><a href=#exemple-concret--règles-de-paiement>Exemple Concret : Règles de Paiement</a></li><li><a href=#avantages-de-lexample-mapping>Avantages de l&rsquo;Example Mapping</a></li><li><a href=#mon-premier-example-mapping-avec-gyroscops>Mon Premier Example Mapping avec Gyroscops</a><ul><li><a href=#la-préparation>La Préparation</a></li><li><a href=#latelier-en-action>L&rsquo;Atelier en Action</a></li><li><a href=#les-découvertes-surprenantes>Les Découvertes Surprenantes</a></li></ul></li><li><a href=#comment-utiliser-lexample-mapping-1>Comment Utiliser l&rsquo;Example Mapping</a><ul><li><a href=#1-avant-de-commencer-un-projet>1. <strong>Avant de Commencer un Projet</strong></a></li><li><a href=#2-pendant-le-développement>2. <strong>Pendant le Développement</strong></a></li><li><a href=#3-pour-écrire-les-tests>3. <strong>Pour Écrire les Tests</strong></a></li></ul></li><li><a href=#les-pièges-à-éviter>Les Pièges à Éviter</a><ul><li><a href=#1-règles-trop-génériques>1. <strong>Règles Trop Génériques</strong></a></li><li><a href=#2-exemples-trop-abstraits>2. <strong>Exemples Trop Abstraits</strong></a></li><li><a href=#3-questions-non-résolues>3. <strong>Questions Non Résolues</strong></a></li><li><a href=#4-scénarios-incomplets>4. <strong>Scénarios Incomplets</strong></a></li></ul></li><li><a href=#lexample-mapping-et-levent-storming>L&rsquo;Example Mapping et l&rsquo;Event Storming</a><ul><li><a href=#la-synergie>La Synergie</a></li><li><a href=#la-progression-logique>La Progression Logique</a></li></ul></li><li><a href=#-implémentation-concrète-dans-le-projet-gyroscops-cloud>🏗️ Implémentation Concrète dans le projet Gyroscops Cloud</a><ul><li><a href=#example-mapping-appliqué-à-gyroscops-cloud>Example Mapping Appliqué à Gyroscops Cloud</a></li><li><a href=#références-aux-adr-du-projet-gyroscops-cloud>Références aux ADR du projet Gyroscops Cloud</a></li><li><a href=#-option-e--je-veux-comprendre-la-granularité-des-choix-architecturaux>🟣 Option E : Je veux comprendre la granularité des choix architecturaux</a></li></ul></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><h1 class="content-title mb-0">Chapitre 4 : L'Example Mapping - Détailer les Règles Métier</h1></div><div id=content class=main-content><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h2 id=-objectif-de-ce-chapitre>🎯 Objectif de ce Chapitre <a href=#-objectif-de-ce-chapitre class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=mon-problème--comment-détailer-les-règles-métier-complexes->Mon Problème : Comment Détailer les Règles Métier Complexes ? <a href=#mon-probl%c3%a8me--comment-d%c3%a9tailer-les-r%c3%a8gles-m%c3%a9tier-complexes- class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Voici ce qui s&rsquo;est passé avec Gyroscops</strong> : Après mon premier Event Storming, j&rsquo;avais identifié les événements et les processus métier. <strong>Parfait !</strong> J&rsquo;avais une vision globale du domaine.</p><p><strong>Mais attendez&mldr;</strong> Quand j&rsquo;ai voulu implémenter la suspension d&rsquo;un utilisateur, j&rsquo;ai découvert que c&rsquo;était beaucoup plus complexe que prévu. &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo; - OK, mais qu&rsquo;est-ce qu&rsquo;un &ldquo;paiement en cours&rdquo; ? Et que se passe-t-il si l&rsquo;utilisateur a des workflows actifs ? Et ses données personnelles ?</p><p><strong>Soudain, je réalisais que l&rsquo;Event Storming ne suffisait pas !</strong> Il me fallait une méthode pour détailler les règles métier complexes.</p><h3 id=lexample-mapping--mon-détective-du-métier>L&rsquo;Example Mapping : Mon Détective du Métier <a href=#lexample-mapping--mon-d%c3%a9tective-du-m%c3%a9tier class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>L&rsquo;Example Mapping, créé par Matt Wynne, m&rsquo;a permis de :</p><ul><li><strong>Détailler</strong> les règles métier complexes</li><li><strong>Clarifier</strong> les cas limites et exceptions</li><li><strong>Transformer</strong> les exemples en tests d&rsquo;acceptation</li><li><strong>Communiquer</strong> efficacement avec les parties prenantes</li></ul><h2 id=quest-ce-que-lexample-mapping->Qu&rsquo;est-ce que l&rsquo;Example Mapping ? <a href=#quest-ce-que-lexample-mapping- class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=le-concept-fondamental>Le Concept Fondamental <a href=#le-concept-fondamental class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>L&rsquo;Example Mapping est une technique complémentaire à l&rsquo;Event Storming qui utilise des cartes colorées pour détailler les règles métier. <strong>L&rsquo;idée</strong> : Au lieu de partir des événements, on part des règles métier et on les illustre avec des exemples concrets.</p><p><strong>Avec Gyroscops, voici comment j&rsquo;ai appliqué l&rsquo;Example Mapping</strong> :</p><h3 id=les-4-types-de-cartes>Les 4 Types de Cartes <a href=#les-4-types-de-cartes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><h4 id=1-cartes-jaunes--règles-métier---le-cœur-du-domaine>1. <strong>Cartes Jaunes : Règles Métier</strong> - Le Cœur du Domaine <a href=#1-cartes-jaunes--r%c3%a8gles-m%c3%a9tier---le-c%c5%93ur-du-domaine class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Exemple concret avec Gyroscops</strong> :</p><ul><li>&ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</li><li>&ldquo;Un utilisateur suspendu ne peut pas créer de nouveaux workflows&rdquo;</li><li>&ldquo;Un workflow ne peut pas être déployé dans une région cloud indisponible&rdquo;</li><li>&ldquo;Un paiement ne peut pas être traité pour une organisation suspendue&rdquo;</li></ul><p><strong>Pourquoi c&rsquo;est important ?</strong> Les règles métier définissent ce qui est possible et ce qui ne l&rsquo;est pas. Elles sont le cœur du domaine.</p><h4 id=2-cartes-vertes--exemples---lillustration-des-règles>2. <strong>Cartes Vertes : Exemples</strong> - L&rsquo;Illustration des Règles <a href=#2-cartes-vertes--exemples---lillustration-des-r%c3%a8gles class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Exemple concret avec Gyroscops</strong> :</p><ul><li><strong>Règle</strong> : &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</li><li><strong>Exemple</strong> : &ldquo;Jean a un paiement de 50€ en attente → Il ne peut pas être suspendu&rdquo;</li><li><strong>Exemple</strong> : &ldquo;Marie n&rsquo;a aucun paiement en attente → Elle peut être suspendue&rdquo;</li></ul><p><strong>Pourquoi c&rsquo;est crucial ?</strong> Les exemples rendent les règles concrètes et compréhensibles.</p><h4 id=3-cartes-bleues--questions---les-cas-limites>3. <strong>Cartes Bleues : Questions</strong> - Les Cas Limites <a href=#3-cartes-bleues--questions---les-cas-limites class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Exemple concret avec Gyroscops</strong> :</p><ul><li><strong>Règle</strong> : &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</li><li><strong>Question</strong> : &ldquo;Que se passe-t-il si le paiement est en échec ?&rdquo;</li><li><strong>Question</strong> : &ldquo;Que se passe-t-il si le paiement est en attente depuis 30 jours ?&rdquo;</li><li><strong>Question</strong> : &ldquo;Que se passe-t-il si l&rsquo;utilisateur a des workflows actifs ?&rdquo;</li></ul><p><strong>Pourquoi c&rsquo;est essentiel ?</strong> Les questions révèlent les cas limites et les exceptions.</p><h4 id=4-cartes-blanches--scénarios---les-histoires-complètes>4. <strong>Cartes Blanches : Scénarios</strong> - Les Histoires Complètes <a href=#4-cartes-blanches--sc%c3%a9narios---les-histoires-compl%c3%a8tes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Exemple concret avec Gyroscops</strong> :</p><ul><li><strong>Scénario</strong> : &ldquo;Suspendre un utilisateur avec paiement en cours&rdquo;</li><li><strong>Scénario</strong> : &ldquo;Suspendre un utilisateur avec workflows actifs&rdquo;</li><li><strong>Scénario</strong> : &ldquo;Suspendre un utilisateur avec données personnelles&rdquo;</li></ul><p><strong>Pourquoi c&rsquo;est la clé ?</strong> Les scénarios montrent comment les règles s&rsquo;appliquent dans des situations réelles.</p><h2 id=pourquoi-lexample-mapping->Pourquoi l&rsquo;Example Mapping ? <a href=#pourquoi-lexample-mapping- class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=1-révéler-les-règles-implicites---mon-détective-du-métier>1. <strong>Révéler les Règles Implicites</strong> - Mon Détective du Métier <a href=#1-r%c3%a9v%c3%a9ler-les-r%c3%a8gles-implicites---mon-d%c3%a9tective-du-m%c3%a9tier class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>L&rsquo;Event Storming révèle les événements, mais l&rsquo;Example Mapping révèle les règles métier complexes qui les gouvernent. <strong>C&rsquo;est comme passer d&rsquo;une photo floue à une photo nette.</strong></p><p><strong>Exemple concret avec Gyroscops</strong> : Je pensais qu&rsquo;un &ldquo;paiement&rdquo; était traité si le montant était positif. Puis l&rsquo;Example Mapping a révélé :</p><p><strong>Règles de paiement simples</strong> :</p><ul><li>Un paiement de 1€ est traité ✅</li><li>Un paiement de 1000€ est traité ✅</li><li>Un paiement de 10000€ nécessite une validation manuelle ❌</li><li>Un paiement de 100000€ nécessite une approbation du directeur ❌</li></ul><p><strong>Règles de paiement complexes</strong> :</p><ul><li>Un paiement avec une carte expirée est rejeté ❌</li><li>Un paiement avec une carte volée est rejeté ❌</li><li>Un paiement depuis un pays interdit est rejeté ❌</li><li>Un paiement d&rsquo;un client en défaut est rejeté ❌</li></ul><p><strong>Règles liées à l&rsquo;organisation</strong> :</p><ul><li>Un paiement pour une organisation suspendue est rejeté ❌</li><li>Un paiement pour une organisation en défaut de paiement est rejeté ❌</li><li>Un paiement pour une organisation sans workflow actif est rejeté ❌</li></ul><p><strong>Règles liées au workflow</strong> :</p><ul><li>Un paiement pour un workflow suspendu est rejeté ❌</li><li>Un paiement pour un workflow dans une région cloud indisponible est rejeté ❌</li><li>Un paiement pour un workflow avec des ressources insuffisantes est rejeté ❌</li></ul><p><strong>Soudain, j&rsquo;ai compris pourquoi ma logique de paiement était si complexe !</strong> Ce n&rsquo;était pas juste un paiement, c&rsquo;était un écosystème complet : User → Organization → Workflow → Cloud Resources → Billing.</p><h3 id=2-concrétiser-l---de-lidée-à-la-réalité>2. <strong>Concrétiser l&rsquo;Abstrait</strong> - De l&rsquo;Idée à la Réalité <a href=#2-concr%c3%a9tiser-l---de-lid%c3%a9e-%c3%a0-la-r%c3%a9alit%c3%a9 class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Les exemples concrets rendent les règles métier tangibles et compréhensibles. <strong>Fini les &ldquo;On devrait peut-être&mldr;&rdquo; et les &ldquo;Il faudrait que&mldr;&rdquo;.</strong></p><p><strong>Exemple concret avec Gyroscops</strong> : Au lieu de dire &ldquo;Un paiement peut être traité&rdquo;, nous disions &ldquo;Un paiement de 100€ avec une carte Visa valide depuis la France peut être traité&rdquo;. <strong>C&rsquo;est beaucoup plus clair !</strong></p><p><strong>Voici comment l&rsquo;Example Mapping a transformé nos discussions</strong> :</p><p><strong>Avant</strong> (discussions abstraites) :</p><ul><li>&ldquo;Il faut valider les paiements&rdquo;</li><li>&ldquo;On doit gérer les cas d&rsquo;erreur&rdquo;</li><li>&ldquo;Il faut respecter les règles de sécurité&rdquo;</li><li>&ldquo;Il faut gérer les organisations&rdquo;</li><li>&ldquo;Il faut gérer les workflows&rdquo;</li><li>&ldquo;Il faut gérer les ressources cloud&rdquo;</li></ul><p><strong>Après</strong> (exemples concrets) :</p><ul><li>&ldquo;Un paiement de 50€ avec une carte Visa valide depuis la France pour une organisation active avec un workflow déployé en région Europe est traité automatiquement&rdquo;</li><li>&ldquo;Un paiement de 5000€ avec une carte Visa valide depuis la France pour une organisation active avec un workflow déployé en région Europe nécessite une validation manuelle&rdquo;</li><li>&ldquo;Un paiement de 50€ avec une carte expirée est rejeté avec le message &lsquo;Carte expirée&rsquo;&rdquo;</li><li>&ldquo;Un paiement de 50€ pour une organisation suspendue est rejeté avec le message &lsquo;Organisation suspendue&rsquo;&rdquo;</li><li>&ldquo;Un paiement de 50€ pour un workflow dans une région cloud indisponible est rejeté avec le message &lsquo;Région cloud indisponible&rsquo;&rdquo;</li><li>&ldquo;Un paiement de 50€ pour un workflow avec des ressources insuffisantes est rejeté avec le message &lsquo;Ressources insuffisantes&rsquo;&rdquo;</li></ul><p><strong>Résultat</strong> : Plus de malentendus, plus de discussions interminables, plus de &ldquo;Ah, je pensais que&mldr;&rdquo;. Tout le monde comprenait exactement ce qui devait être fait, et nous avons découvert que chaque paiement impliquait une chaîne complète : User → Organization → Workflow → Cloud Resources → Billing.</p><h3 id=3-faciliter-les-tests---de-lexemple-au-code>3. <strong>Faciliter les Tests</strong> - De l&rsquo;Exemple au Code <a href=#3-faciliter-les-tests---de-lexemple-au-code class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Les exemples deviennent naturellement des tests d&rsquo;acceptation. <strong>C&rsquo;est la magie de l&rsquo;Example Mapping !</strong></p><p><strong>Avec Gyroscops, voici ce qui s&rsquo;est passé</strong> : Après notre session d&rsquo;Example Mapping sur les paiements, j&rsquo;ai directement transformé les exemples en tests. Voici un exemple réel du projet Gyroscops Cloud :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldHydrateInstanceWithValidData</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 🟢 EXEMPLE : Hydratation d&#39;un paiement avec des données valides (projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $paymentData <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>createValidPaymentData</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $result <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrator</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrate</span>($paymentData);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertInstanceOf</span>(<span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>, $result);
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>($paymentData[<span style=color:#e6db74>&#39;uuid&#39;</span>], $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>uuid</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>($paymentData[<span style=color:#e6db74>&#39;status&#39;</span>], $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>($paymentData[<span style=color:#e6db74>&#39;gateway&#39;</span>], $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>gateway</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldRejectInvalidPaymentData</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 🔴 EXEMPLE : Rejet de données de paiement invalides (projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectException</span>(<span style=color:#a6e22e>MultipleValidationException</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $invalidData <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;uuid&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;invalid-uuid&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;status&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;invalid-status&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;gateway&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;invalid-gateway&#39;</span>,
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrator</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hydrate</span>($invalidData);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_requires_manual_validation_for_large_payment</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 🟡 EXEMPLE : Paiement de 5000€ avec carte Visa valide depuis la France pour une organisation active avec un workflow déployé en région Europe
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $organization <span style=color:#f92672>=</span> <span style=color:#a6e22e>Organization</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(<span style=color:#e6db74>&#39;Acme Corp&#39;</span>, <span style=color:#e6db74>&#39;active&#39;</span>);
</span></span><span style=display:flex><span>    $workflow <span style=color:#f92672>=</span> <span style=color:#a6e22e>Workflow</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>($organization, <span style=color:#a6e22e>CloudRegion</span><span style=color:#f92672>::</span><span style=color:#a6e22e>europe</span>(), <span style=color:#e6db74>&#39;active&#39;</span>);
</span></span><span style=display:flex><span>    $payment <span style=color:#f92672>=</span> <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>5000</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentMethod</span><span style=color:#f92672>::</span><span style=color:#a6e22e>visa</span>(<span style=color:#e6db74>&#39;4111111111111111&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Country</span><span style=color:#f92672>::</span><span style=color:#a6e22e>france</span>(),
</span></span><span style=display:flex><span>        $organization,
</span></span><span style=display:flex><span>        $workflow
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>process</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#a6e22e>PaymentStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PENDING_MANUAL_VALIDATION</span>, $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getStatus</span>());
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_rejects_payment_for_suspended_organization</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 🔴 EXEMPLE : Paiement de 50€ pour une organisation suspendue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectException</span>(<span style=color:#a6e22e>SuspendedOrganizationException</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectExceptionMessage</span>(<span style=color:#e6db74>&#39;Organisation suspendue&#39;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $organization <span style=color:#f92672>=</span> <span style=color:#a6e22e>Organization</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(<span style=color:#e6db74>&#39;Acme Corp&#39;</span>, <span style=color:#e6db74>&#39;suspended&#39;</span>);
</span></span><span style=display:flex><span>    $workflow <span style=color:#f92672>=</span> <span style=color:#a6e22e>Workflow</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>($organization, <span style=color:#a6e22e>CloudRegion</span><span style=color:#f92672>::</span><span style=color:#a6e22e>europe</span>(), <span style=color:#e6db74>&#39;active&#39;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>50</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentMethod</span><span style=color:#f92672>::</span><span style=color:#a6e22e>visa</span>(<span style=color:#e6db74>&#39;4111111111111111&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Country</span><span style=color:#f92672>::</span><span style=color:#a6e22e>france</span>(),
</span></span><span style=display:flex><span>        $organization,
</span></span><span style=display:flex><span>        $workflow
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_rejects_payment_for_workflow_in_unavailable_region</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 🔴 EXEMPLE : Paiement de 50€ pour un workflow dans une région cloud indisponible
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectException</span>(<span style=color:#a6e22e>UnavailableCloudRegionException</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>    $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectExceptionMessage</span>(<span style=color:#e6db74>&#39;Région cloud indisponible&#39;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $organization <span style=color:#f92672>=</span> <span style=color:#a6e22e>Organization</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(<span style=color:#e6db74>&#39;Acme Corp&#39;</span>, <span style=color:#e6db74>&#39;active&#39;</span>);
</span></span><span style=display:flex><span>    $workflow <span style=color:#f92672>=</span> <span style=color:#a6e22e>Workflow</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>($organization, <span style=color:#a6e22e>CloudRegion</span><span style=color:#f92672>::</span><span style=color:#a6e22e>asia</span>(), <span style=color:#e6db74>&#39;active&#39;</span>); <span style=color:#75715e>// Région indisponible
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>50</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentMethod</span><span style=color:#f92672>::</span><span style=color:#a6e22e>visa</span>(<span style=color:#e6db74>&#39;4111111111111111&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Country</span><span style=color:#f92672>::</span><span style=color:#a6e22e>france</span>(),
</span></span><span style=display:flex><span>        $organization,
</span></span><span style=display:flex><span>        $workflow
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Résultat</strong> : J&rsquo;ai écrit mes tests en 30 minutes au lieu de 3 heures ! Et mes tests couvraient exactement les cas métier identifiés par l&rsquo;équipe, incluant toute la chaîne : User → Organization → Workflow → Cloud Resources → Billing.</p><h2 id=exemple-dexample-mapping--traitement-dun-paiement>Exemple d&rsquo;Example Mapping : Traitement d&rsquo;un Paiement <a href=#exemple-dexample-mapping--traitement-dun-paiement class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>Voici un exemple concret d&rsquo;Example Mapping avec des post-it colorés pour illustrer la méthode :</p><figure><img src=/images/example-mapping/example-mapping-overview.svg><figcaption><h4>Vue d'ensemble de l'Example Mapping - Traitement d'un Paiement</h4></figcaption></figure><h3 id=-règles-métier-post-it-jaunes>🟡 <strong>Règles Métier (Post-it Jaunes)</strong> <a href=#-r%c3%a8gles-m%c3%a9tier-post-it-jaunes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><figure><img src=/images/example-mapping/rule-payment-pending.svg><figcaption><h4>Règle : Paiement en statut pending uniquement</h4></figcaption></figure><figure><img src=/images/example-mapping/rule-amount-positive.svg><figcaption><h4>Règle : Montant positif obligatoire</h4></figcaption></figure><figure><img src=/images/example-mapping/rule-amount-limit.svg><figcaption><h4>Règle : Ne pas dépasser la limite du compte</h4></figcaption></figure><figure><img src=/images/example-mapping/rule-payment-immutable.svg><figcaption><h4>Règle : Paiement traité non modifiable</h4></figcaption></figure><h3 id=-exemples-concrets-post-it-verts>🟢 <strong>Exemples Concrets (Post-it Verts)</strong> <a href=#-exemples-concrets-post-it-verts class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><figure><img src=/images/example-mapping/example-valid-payment.svg><figcaption><h4>Exemple : Paiement de 100€ avec compte ayant une limite de 500€</h4></figcaption></figure><figure><img src=/images/example-mapping/example-negative-amount.svg><figcaption><h4>Exemple : Paiement de -50€</h4></figcaption></figure><figure><img src=/images/example-mapping/example-exceed-limit.svg><figcaption><h4>Exemple : Paiement de 600€ avec compte ayant une limite de 500€</h4></figcaption></figure><figure><img src=/images/example-mapping/example-already-processed.svg><figcaption><h4>Exemple : Tentative de traiter un paiement déjà traité</h4></figcaption></figure><h3 id=-questions-à-explorer-post-it-rouges>🔴 <strong>Questions à Explorer (Post-it Rouges)</strong> <a href=#-questions-%c3%a0-explorer-post-it-rouges class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><figure><img src=/images/example-mapping/question-suspended-account.svg><figcaption><h4>Question : Que se passe-t-il si le compte est suspendu ?</h4></figcaption></figure><figure><img src=/images/example-mapping/question-time-limit.svg><figcaption><h4>Question : Y a-t-il une limite de temps pour traiter un paiement ?</h4></figcaption></figure><figure><img src=/images/example-mapping/question-partial-payment.svg><figcaption><h4>Question : Peut-on traiter un paiement partiellement ?</h4></figcaption></figure><h3 id=-scénario-d>🔵 <strong>Scénario d&rsquo;Usage (Post-it Bleu)</strong> <a href=#-sc%c3%a9nario-d class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><figure><img src=/images/example-mapping/scenario-payment-process.svg><figcaption><h4>Scénario : Processus complet de paiement</h4></figcaption></figure><p><strong>Processus complet de paiement :</strong></p><ol><li>Client initie un paiement</li><li>Système valide le montant</li><li>Système vérifie la limite du compte</li><li>Système traite le paiement</li><li>Système envoie une confirmation</li></ol><h2 id=comment-utiliser-lexample-mapping>Comment Utiliser l&rsquo;Example Mapping <a href=#comment-utiliser-lexample-mapping class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=1-après-l>1. <strong>Après l&rsquo;Event Storming</strong> <a href=#1-apr%c3%a8s-l class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Utilisez l&rsquo;Example Mapping pour détailler les événements les plus complexes découverts lors de l&rsquo;Event Storming.</p><h3 id=2-en-petite-équipe>2. <strong>En Petite Équipe</strong> <a href=#2-en-petite-%c3%a9quipe class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>3-5 personnes maximum : un expert métier, un développeur, un testeur.</p><h3 id=3-durée-limitée>3. <strong>Durée Limitée</strong> <a href=#3-dur%c3%a9e-limit%c3%a9e class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>30-45 minutes par fonctionnalité pour éviter l&rsquo;over-engineering.</p><h3 id=4-focus-sur-les-cas-limites>4. <strong>Focus sur les Cas Limites</strong> <a href=#4-focus-sur-les-cas-limites class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Concentrez-vous sur les règles métier complexes et les cas d&rsquo;erreur.</p><h2 id=exemple-concret--règles-de-paiement>Exemple Concret : Règles de Paiement <a href=#exemple-concret--r%c3%a8gles-de-paiement class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Les exemples de l&#39;Example Mapping deviennent des tests
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PaymentTest</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>TestCase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_processes_a_valid_payment</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 🟢 EXEMPLE : Paiement de 100€ avec compte ayant une limite de 500€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $payment <span style=color:#f92672>=</span> <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $account <span style=color:#f92672>=</span> <span style=color:#a6e22e>Account</span><span style=color:#f92672>::</span><span style=color:#a6e22e>withLimit</span>(<span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>500</span>));
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>process</span>($account);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#a6e22e>PaymentStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PROCESSED</span>, $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getStatus</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_rejects_negative_amount</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 🟢 EXEMPLE : Paiement de -50€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectException</span>(<span style=color:#a6e22e>InvalidAmountException</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_rejects_amount_exceeding_limit</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 🟢 EXEMPLE : Paiement de 600€ avec compte ayant une limite de 500€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $payment <span style=color:#f92672>=</span> <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $account <span style=color:#f92672>=</span> <span style=color:#a6e22e>Account</span><span style=color:#f92672>::</span><span style=color:#a6e22e>withLimit</span>(<span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>euros</span>(<span style=color:#ae81ff>500</span>));
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectException</span>(<span style=color:#a6e22e>AmountExceedsLimitException</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>process</span>($account);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=avantages-de-lexample-mapping>Avantages de l&rsquo;Example Mapping <a href=#avantages-de-lexample-mapping class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><ol><li><strong>Clarté des Règles</strong> : Les exemples concrets clarifient les règles métier</li><li><strong>Tests Automatiques</strong> : Les exemples deviennent des tests d&rsquo;acceptation</li><li><strong>Communication</strong> : Toute l&rsquo;équipe comprend les mêmes règles</li><li><strong>Évolution</strong> : Facile d&rsquo;ajouter de nouveaux exemples quand les règles changent</li></ol><h2 id=mon-premier-example-mapping-avec-gyroscops>Mon Premier Example Mapping avec Gyroscops <a href=#mon-premier-example-mapping-avec-gyroscops class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=la-préparation>La Préparation <a href=#la-pr%c3%a9paration class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Voici comment j&rsquo;ai organisé mon premier Example Mapping</strong> :</p><ol><li><strong>Participants</strong> : Moi (CTO), le CEO, le responsable commercial, 2 clients existants</li><li><strong>Durée</strong> : 2 heures</li><li><strong>Matériel</strong> : Post-its de 4 couleurs, marqueurs, tableau blanc</li><li><strong>Focus</strong> : &ldquo;Suspendre un utilisateur&rdquo; (règle complexe identifiée lors de l&rsquo;Event Storming)</li></ol><h3 id=latelier-en-action>L&rsquo;Atelier en Action <a href=#latelier-en-action class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><h4 id=étape-1--identifier-la-règle-métier>Étape 1 : Identifier la Règle Métier <a href=#%c3%a9tape-1--identifier-la-r%c3%a8gle-m%c3%a9tier class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Discussion</strong> : &ldquo;Quelle est la règle pour suspendre un utilisateur ?&rdquo;</p><p><strong>Règle identifiée</strong> : &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</p><p><strong>Résultat</strong> : Règle claire et partagée par tous.</p><h4 id=étape-2--illustrer-avec-des-exemples>Étape 2 : Illustrer avec des Exemples <a href=#%c3%a9tape-2--illustrer-avec-des-exemples class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Discussion</strong> : &ldquo;Donnez-moi des exemples concrets&rdquo;</p><p><strong>Exemples identifiés</strong> :</p><ul><li><strong>Exemple 1</strong> : &ldquo;Jean a un paiement de 50€ en attente → Il ne peut pas être suspendu&rdquo;</li><li><strong>Exemple 2</strong> : &ldquo;Marie n&rsquo;a aucun paiement en attente → Elle peut être suspendue&rdquo;</li><li><strong>Exemple 3</strong> : &ldquo;Pierre a un paiement de 100€ en attente → Il ne peut pas être suspendu&rdquo;</li></ul><p><strong>Résultat</strong> : Règle illustrée avec des exemples concrets.</p><h4 id=étape-3--identifier-les-questions>Étape 3 : Identifier les Questions <a href=#%c3%a9tape-3--identifier-les-questions class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Discussion</strong> : &ldquo;Quelles questions vous viennent à l&rsquo;esprit ?&rdquo;</p><p><strong>Questions identifiées</strong> :</p><ul><li>&ldquo;Que se passe-t-il si le paiement est en échec ?&rdquo;</li><li>&ldquo;Que se passe-t-il si le paiement est en attente depuis 30 jours ?&rdquo;</li><li>&ldquo;Que se passe-t-il si l&rsquo;utilisateur a des workflows actifs ?&rdquo;</li><li>&ldquo;Que se passe-t-il si l&rsquo;utilisateur a des données personnelles ?&rdquo;</li></ul><p><strong>Résultat</strong> : Cas limites et exceptions identifiés.</p><h4 id=étape-4--développer-les-scénarios>Étape 4 : Développer les Scénarios <a href=#%c3%a9tape-4--d%c3%a9velopper-les-sc%c3%a9narios class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Discussion</strong> : &ldquo;Comment ces règles s&rsquo;appliquent-elles dans des situations réelles ?&rdquo;</p><p><strong>Scénarios identifiés</strong> :</p><ul><li><strong>Scénario 1</strong> : &ldquo;Suspendre un utilisateur avec paiement en cours&rdquo;<ul><li>Règle : &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</li><li>Exemple : &ldquo;Jean a un paiement de 50€ en attente&rdquo;</li><li>Résultat : &ldquo;Jean ne peut pas être suspendu&rdquo;</li></ul></li><li><strong>Scénario 2</strong> : &ldquo;Suspendre un utilisateur avec workflows actifs&rdquo;<ul><li>Règle : &ldquo;Un utilisateur suspendu ne peut pas créer de nouveaux workflows&rdquo;</li><li>Exemple : &ldquo;Marie a 3 workflows actifs&rdquo;</li><li>Résultat : &ldquo;Marie peut être suspendue, mais ses workflows restent actifs&rdquo;</li></ul></li></ul><p><strong>Résultat</strong> : Scénarios complets et testables.</p><h3 id=les-découvertes-surprenantes>Les Découvertes Surprenantes <a href=#les-d%c3%a9couvertes-surprenantes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><h4 id=1-les-règles-métier-cachées>1. <strong>Les Règles Métier Cachées</strong> <a href=#1-les-r%c3%a8gles-m%c3%a9tier-cach%c3%a9es class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Avant l&rsquo;Example Mapping</strong> : Je pensais que suspendre un utilisateur était simple.</p><p><strong>Après l&rsquo;Example Mapping</strong> : J&rsquo;ai découvert que suspendre un utilisateur impliquait de gérer ses paiements, ses workflows, ses intégrations, et ses données.</p><p><strong>Résultat</strong> : J&rsquo;ai compris pourquoi cette fonctionnalité était si complexe à implémenter !</p><h4 id=2-les-cas-limites-complexes>2. <strong>Les Cas Limites Complexes</strong> <a href=#2-les-cas-limites-complexes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Avant l&rsquo;Example Mapping</strong> : Je pensais que &ldquo;paiement en cours&rdquo; était clair.</p><p><strong>Après l&rsquo;Example Mapping</strong> : J&rsquo;ai découvert qu&rsquo;il fallait gérer les paiements en échec, les paiements en attente, les paiements expirés, etc.</p><p><strong>Résultat</strong> : J&rsquo;ai compris pourquoi mes tests étaient si fragiles !</p><h4 id=3-les-exceptions-métier>3. <strong>Les Exceptions Métier</strong> <a href=#3-les-exceptions-m%c3%a9tier class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Avant l&rsquo;Example Mapping</strong> : Je pensais que les règles étaient absolues.</p><p><strong>Après l&rsquo;Example Mapping</strong> : J&rsquo;ai découvert qu&rsquo;il y avait des exceptions pour les cas d&rsquo;urgence, les cas de force majeure, etc.</p><p><strong>Résultat</strong> : J&rsquo;ai compris pourquoi mes règles métier étaient si rigides !</p><h2 id=comment-utiliser-lexample-mapping-1>Comment Utiliser l&rsquo;Example Mapping <a href=#comment-utiliser-lexample-mapping-1 class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=1-avant-de-commencer-un-projet>1. <strong>Avant de Commencer un Projet</strong> <a href=#1-avant-de-commencer-un-projet class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Avec Gyroscops</strong> : Avant de développer une nouvelle fonctionnalité, je fais toujours un mini Example Mapping :</p><ul><li><strong>Règle</strong> : Quelle est la règle métier principale ?</li><li><strong>Exemples</strong> : Quels sont les exemples concrets ?</li><li><strong>Questions</strong> : Quelles sont les questions qui se posent ?</li><li><strong>Scénarios</strong> : Quels sont les scénarios complets ?</li></ul><p><strong>Résultat</strong> : Fonctionnalité bien comprise avant le développement.</p><h3 id=2-pendant-le-développement>2. <strong>Pendant le Développement</strong> <a href=#2-pendant-le-d%c3%a9veloppement class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Avec Gyroscops</strong> : Quand je développe une fonctionnalité, je me demande constamment :</p><ul><li>&ldquo;Est-ce que cette règle métier est bien implémentée ?&rdquo;</li><li>&ldquo;Est-ce que ces exemples sont bien couverts ?&rdquo;</li><li>&ldquo;Est-ce que ces questions sont bien gérées ?&rdquo;</li><li>&ldquo;Est-ce que ces scénarios sont bien testés ?&rdquo;</li></ul><p><strong>Résultat</strong> : Développement guidé par les règles métier.</p><h3 id=3-pour-écrire-les-tests>3. <strong>Pour Écrire les Tests</strong> <a href=#3-pour-%c3%a9crire-les-tests class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Avec Gyroscops</strong> : Quand j&rsquo;écris les tests, je transforme les exemples en tests d&rsquo;acceptation :</p><ul><li><strong>Exemple</strong> : &ldquo;Jean a un paiement de 50€ en attente → Il ne peut pas être suspendu&rdquo;</li><li><strong>Test</strong> : <code>it_prevents_suspending_user_with_pending_payment()</code></li><li><strong>Résultat</strong> : Tests basés sur les exemples métier</li></ul><p><strong>Résultat</strong> : Tests qui reflètent la réalité métier.</p><h2 id=les-pièges-à-éviter>Les Pièges à Éviter <a href=#les-pi%c3%a8ges-%c3%a0-%c3%a9viter class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=1-règles-trop-génériques>1. <strong>Règles Trop Génériques</strong> <a href=#1-r%c3%a8gles-trop-g%c3%a9n%c3%a9riques class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>❌ Mauvais</strong> : &ldquo;Un utilisateur ne peut pas être suspendu&rdquo;
<strong>✅ Bon</strong> : &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</p><p><strong>Pourquoi c&rsquo;est important ?</strong> Des règles trop génériques ne permettent pas de comprendre les cas spécifiques.</p><h3 id=2-exemples-trop-abstraits>2. <strong>Exemples Trop Abstraits</strong> <a href=#2-exemples-trop-abstraits class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>❌ Mauvais</strong> : &ldquo;Un utilisateur avec des paiements&rdquo;
<strong>✅ Bon</strong> : &ldquo;Jean a un paiement de 50€ en attente&rdquo;</p><p><strong>Pourquoi c&rsquo;est crucial ?</strong> Des exemples trop abstraits ne permettent pas de comprendre la règle.</p><h3 id=3-questions-non-résolues>3. <strong>Questions Non Résolues</strong> <a href=#3-questions-non-r%c3%a9solues class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>❌ Mauvais</strong> : &ldquo;Que se passe-t-il si&mldr; ?&rdquo; (sans réponse)
<strong>✅ Bon</strong> : &ldquo;Que se passe-t-il si le paiement est en échec ?&rdquo; → &ldquo;Le paiement est annulé et l&rsquo;utilisateur peut être suspendu&rdquo;</p><p><strong>Pourquoi c&rsquo;est essentiel ?</strong> Des questions non résolues créent de l&rsquo;incertitude.</p><h3 id=4-scénarios-incomplets>4. <strong>Scénarios Incomplets</strong> <a href=#4-sc%c3%a9narios-incomplets class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>❌ Mauvais</strong> : &ldquo;Suspendre un utilisateur&rdquo; (sans détails)
<strong>✅ Bon</strong> : &ldquo;Suspendre un utilisateur avec paiement en cours&rdquo; (avec règle, exemple, et résultat)</p><p><strong>Pourquoi c&rsquo;est la clé ?</strong> Des scénarios incomplets ne permettent pas de tester la fonctionnalité.</p><h2 id=lexample-mapping-et-levent-storming>L&rsquo;Example Mapping et l&rsquo;Event Storming <a href=#lexample-mapping-et-levent-storming class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=la-synergie>La Synergie <a href=#la-synergie class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>L&rsquo;Event Storming</strong> me dit <strong>quels</strong> événements se produisent.
<strong>L&rsquo;Example Mapping</strong> me dit <strong>quand</strong> et <strong>pourquoi</strong> ils se produisent.</p><p><strong>Avec Gyroscops</strong> :</p><ol><li><strong>Event Storming</strong> : &ldquo;Quand un utilisateur est suspendu, l&rsquo;événement <code>UserSuspended</code> se produit&rdquo;</li><li><strong>Example Mapping</strong> : &ldquo;Quelles sont les règles pour suspendre un utilisateur ?&rdquo; → &ldquo;Un utilisateur ne peut pas être suspendu s&rsquo;il a des paiements en cours&rdquo;</li><li><strong>Résultat</strong> : Règles métier détaillées et testables</li></ol><h3 id=la-progression-logique>La Progression Logique <a href=#la-progression-logique class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><ol><li><strong>Event Storming</strong> : Comprendre le domaine métier</li><li><strong>Example Mapping</strong> : Détailer les règles métier</li><li><strong>Développement</strong> : Implémenter les fonctionnalités</li></ol><p><strong>Résultat</strong> : Développement guidé par le domaine métier.</p><h2 id=-implémentation-concrète-dans-le-projet-gyroscops-cloud>🏗️ Implémentation Concrète dans le projet Gyroscops Cloud <a href=#-impl%c3%a9mentation-concr%c3%a8te-dans-le-projet-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=example-mapping-appliqué-à-gyroscops-cloud>Example Mapping Appliqué à Gyroscops Cloud <a href=#example-mapping-appliqu%c3%a9-%c3%a0-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Le projet Gyroscops Cloud applique concrètement les principes de l&rsquo;Example Mapping à travers ses tests et ses ADR (Architecture Decision Records). Voici comment :</p><h4 id=exemples-concrets-dexample-mapping>Exemples Concrets d&rsquo;Example Mapping <a href=#exemples-concrets-dexample-mapping class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><p><strong>Règle Métier</strong> : &ldquo;Un utilisateur doit pouvoir se connecter avec son email et son mot de passe&rdquo;</p><p><strong>Exemples</strong> :</p><ul><li>✅ <strong>Email valide + mot de passe correct</strong> → Connexion réussie</li><li>❌ <strong>Email invalide + mot de passe correct</strong> → Erreur de validation</li><li>❌ <strong>Email valide + mot de passe incorrect</strong> → Erreur d&rsquo;authentification</li><li>❌ <strong>Email vide + mot de passe vide</strong> → Erreur de validation</li></ul><p><strong>Questions</strong> :</p><ul><li>Que se passe-t-il si l&rsquo;utilisateur est désactivé ?</li><li>Que se passe-t-il si l&rsquo;utilisateur a trop de tentatives de connexion ?</li><li>Que se passe-t-il si l&rsquo;utilisateur n&rsquo;a pas confirmé son email ?</li></ul><h4 id=implémentation-des-exemples>Implémentation des Exemples <a href=#impl%c3%a9mentation-des-exemples class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Tests d&#39;Example Mapping Gyroscops Cloud (projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserAuthenticationExampleMappingTest</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>TestCase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldAuthenticateUserWithValidCredentials</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Given: Un utilisateur avec des identifiants valides
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $user <span style=color:#f92672>=</span> <span style=color:#a6e22e>UserFixtures</span><span style=color:#f92672>::</span><span style=color:#a6e22e>createActiveUser</span>();
</span></span><span style=display:flex><span>        $email <span style=color:#f92672>=</span> $user<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getEmail</span>();
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;validPassword123!&#39;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// When: L&#39;utilisateur tente de se connecter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $result <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticationService</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticate</span>($email, $password);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Then: La connexion doit réussir
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertTrue</span>($result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isSuccess</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>($user<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getId</span>(), $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getUser</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getId</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldRejectInvalidEmail</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Given: Un email invalide
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;invalid-email&#39;</span>;
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;validPassword123!&#39;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// When: L&#39;utilisateur tente de se connecter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $result <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticationService</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticate</span>($email, $password);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Then: La connexion doit échouer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertFalse</span>($result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isSuccess</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertStringContains</span>(<span style=color:#e6db74>&#39;Invalid email format&#39;</span>, $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getError</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldRejectIncorrectPassword</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Given: Un utilisateur avec un mot de passe incorrect
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $user <span style=color:#f92672>=</span> <span style=color:#a6e22e>UserFixtures</span><span style=color:#f92672>::</span><span style=color:#a6e22e>createActiveUser</span>();
</span></span><span style=display:flex><span>        $email <span style=color:#f92672>=</span> $user<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getEmail</span>();
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;wrongPassword&#39;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// When: L&#39;utilisateur tente de se connecter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $result <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticationService</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticate</span>($email, $password);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Then: La connexion doit échouer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertFalse</span>($result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isSuccess</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertStringContains</span>(<span style=color:#e6db74>&#39;Invalid credentials&#39;</span>, $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getError</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#e6db74>/** @test */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>itShouldRejectEmptyCredentials</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Given: Des identifiants vides
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// When: L&#39;utilisateur tente de se connecter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $result <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticationService</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>authenticate</span>($email, $password);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Then: La connexion doit échouer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertFalse</span>($result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isSuccess</span>());
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertStringContains</span>(<span style=color:#e6db74>&#39;Email and password are required&#39;</span>, $result<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getError</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h4 id=règles-métier-découvertes>Règles Métier Découvertes <a href=#r%c3%a8gles-m%c3%a9tier-d%c3%a9couvertes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Règles Métier Gyroscops Cloud (projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HiveBusinessRules</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Règles d&#39;Authentification
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>USER_EMAIL_MUST_BE_VALID</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;user.email.must.be.valid&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>USER_PASSWORD_MUST_BE_STRONG</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;user.password.must.be.strong&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>USER_MUST_BE_ACTIVE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;user.must.be.active&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>USER_MUST_HAVE_CONFIRMED_EMAIL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;user.must.have.confirmed.email&#39;</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Règles de Paiement
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>PAYMENT_AMOUNT_MUST_BE_POSITIVE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;payment.amount.must.be.positive&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>PAYMENT_CURRENCY_MUST_BE_SUPPORTED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;payment.currency.must.be.supported&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>PAYMENT_CUSTOMER_MUST_EXIST</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;payment.customer.must.exist&#39;</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Règles d&#39;Intégration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>INTEGRATION_CONFIG_MUST_BE_VALID</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;integration.config.must.be.valid&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>INTEGRATION_MUST_PASS_TESTS</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;integration.must.pass.tests&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>INTEGRATION_MUST_HAVE_MONITORING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;integration.must.have.monitoring&#39;</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=références-aux-adr-du-projet-gyroscops-cloud>Références aux ADR du projet Gyroscops Cloud <a href=#r%c3%a9f%c3%a9rences-aux-adr-du-projet-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Ce chapitre s&rsquo;appuie sur les Architecture Decision Records (ADR) suivants du projet Gyroscops Cloud :</p><ul><li><strong>HIVE027</strong> : PHPUnit Testing Standards - Standards de tests PHPUnit</li><li><strong>HIVE023</strong> : Repository Testing Strategies - Stratégies de tests des repositories</li><li><strong>HIVE028</strong> : Faker for test data generation - Génération de données de test avec Faker</li><li><strong>HIVE040</strong> : Enhanced Models with Property Access Patterns - Modèles enrichis pour les tests</li></ul><hr><h3 id=-option-e--je-veux-comprendre-la-granularité-des-choix-architecturaux>🟣 Option E : Je veux comprendre la granularité des choix architecturaux <a href=#-option-e--je-veux-comprendre-la-granularit%c3%a9-des-choix-architecturaux class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><em>Vous voulez savoir comment choisir l&rsquo;architecture au bon niveau</em></p><p><strong>Critères</strong> :</p><ul><li>Équipe expérimentée</li><li>Besoin de comprendre la granularité</li><li>Choix architecturaux à faire</li><li>Cohérence à maintenir</li></ul><p><strong>Temps estimé</strong> : 20-30 minutes</p><p>→ <strong><a href=/chapitres/fondamentaux/chapitre-06-granularite-choix-architecturaux/>Aller au Chapitre 6</a></strong> (Granularité des Choix Architecturaux)</p><hr><p><strong>💡 Conseil</strong> : Si vous n&rsquo;êtes pas sûr, choisissez l&rsquo;option A pour comprendre l&rsquo;architecture événementielle, puis continuez avec les autres chapitres dans l&rsquo;ordre.</p><p><strong>🔄 Alternative</strong> : Si vous voulez tout voir dans l&rsquo;ordre, commencez par le <a href=/chapitres/fondamentaux/chapitre-05-complexite-accidentelle-essentielle/>Chapitre 5</a>.</p><div class=chapter-navigation><h2 class=chapter-nav-title>🎯 Votre Prochaine Étape</h2><p class=chapter-nav-subtitle>Maintenant que vous comprenez les concepts de base et que j'ai partagé mon expérience avec Gyroscops, quel est votre contexte ?</p><div class=chapter-options><div class=chapter-option data-color=yellow data-draft=true><div class=chapter-option-header><div class=chapter-option-letter>A</div><div><h3 class=chapter-option-title>Je veux comprendre la complexité architecturale</h3><p class=chapter-option-subtitle>Vous voulez savoir quand utiliser quels patterns</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Équipe expérimentée</li><li>Besoin de choisir une architecture</li><li>Projet avec contraintes techniques</li><li>Décision architecturale à prendre</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 20-30 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Complexité Accidentelle vs Essentielle
<span class=draft-indicator>📝</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=red data-draft=true><div class=chapter-option-header><div class=chapter-option-letter>B</div><div><h3 class=chapter-option-title>Je veux voir des exemples concrets de modèles</h3><p class=chapter-option-subtitle>Vous voulez comprendre la différence entre modèles riches et anémiques</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Développeur avec expérience</li><li>Besoin d'exemples pratiques</li><li>Compréhension des patterns de code</li><li>Implémentation à faire</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 25-35 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Modèles Riches vs Modèles Anémiques
<span class=draft-indicator>📝</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=green data-draft=true><div class=chapter-option-header><div class=chapter-option-letter>C</div><div><h3 class=chapter-option-title>Je veux comprendre l'architecture événementielle</h3><p class=chapter-option-subtitle>Vous voulez voir comment structurer votre code autour des événements</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Développeur avec expérience</li><li>Besoin de découpler les composants</li><li>Système complexe à maintenir</li><li>Évolutivité importante</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 25-35 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Architecture Événementielle
<span class=draft-indicator>📝</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=blue data-draft=true><div class=chapter-option-header><div class=chapter-option-letter>D</div><div><h3 class=chapter-option-title>Je veux comprendre les repositories et la persistance</h3><p class=chapter-option-subtitle>Vous voulez voir comment gérer la persistance des données</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Développeur avec expérience</li><li>Besoin de comprendre la persistance</li><li>Architecture à définir</li><li>Patterns de stockage à choisir</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 25-35 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Repositories et Persistance
<span class=draft-indicator>📝</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style></div></div><style>.chapter-navigation{margin:2rem 0;padding:1.5rem;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);border-radius:12px;border-left:4px solid #3b82f6}.chapter-nav-title{margin:0 0 .5rem;font-size:1.5rem;font-weight:700;color:#1e293b}.chapter-nav-subtitle{margin:0 0 1.5rem;color:#64748b;font-size:1rem;line-height:1.6}.chapter-options{display:flex;flex-direction:column;gap:1rem}.chapter-option{background:#fff;border-radius:8px;padding:1.25rem;border:1px solid #e2e8f0;transition:all .2s ease;position:relative;overflow:hidden}.chapter-option:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.1);border-color:#3b82f6}.chapter-option::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--option-color,#6b7280);border-radius:0 2px 2px 0}.chapter-option-header{display:flex;align-items:center;margin-bottom:.75rem}.chapter-option-letter{display:inline-flex;align-items:center;justify-content:center;width:2rem;height:2rem;border-radius:50%;background:var(--option-color,#6b7280);color:#fff;font-weight:700;font-size:.875rem;margin-right:.75rem;flex-shrink:0}.chapter-option-title{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0;line-height:1.4}.chapter-option-subtitle{font-size:.875rem;color:#64748b;font-style:italic;margin:.25rem 0 0;line-height:1.4}.chapter-option-content{margin-left:2.75rem}.chapter-option-criteria{margin-bottom:.75rem}.chapter-option-criteria-title{font-size:.875rem;font-weight:600;color:#374151;margin:0 0 .5rem}.chapter-option-criteria-list{list-style:none;padding:0;margin:0}.chapter-option-criteria-list li{position:relative;padding-left:1.25rem;margin-bottom:.25rem;font-size:.875rem;color:#4b5563;line-height:1.4}.chapter-option-criteria-list li::before{content:'✓';position:absolute;left:0;color:#10b981;font-weight:600}.chapter-option-footer{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;padding-top:.75rem;border-top:1px solid #e5e7eb}.chapter-option-time{font-size:.875rem;color:#6b7280;font-weight:500}.chapter-option-link{display:inline-flex;align-items:center;padding:.5rem 1rem;background:var(--option-color,#6b7280);color:#fff!important;text-decoration:none!important;border-radius:6px;font-weight:600;font-size:.875rem;transition:all .2s ease;border:none;cursor:pointer}.chapter-option-link:hover{background:var(--option-color-dark,#4b5563);color:#fff!important;text-decoration:none!important;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.15)}.chapter-option-link:visited{color:#fff!important;text-decoration:none!important}.chapter-option-link:focus{color:#fff!important;text-decoration:none!important;outline:2px solid rgba(255,255,255,.5);outline-offset:2px}.chapter-option-link:active{color:#fff!important;text-decoration:none!important}.chapter-option-link::after{content:'→';margin-left:.5rem;transition:transform .2s ease;color:#fff!important}.chapter-option-link:hover::after{transform:translateX(2px);color:#fff!important}.chapter-navigation a{color:inherit;text-decoration:none}.chapter-navigation a:hover{color:inherit;text-decoration:none}.chapter-navigation a:visited{color:inherit;text-decoration:none}.chapter-navigation a:focus{color:inherit;text-decoration:none}.chapter-navigation a:active{color:inherit;text-decoration:none}.chapter-option[data-color=green]{--option-color:#10b981;--option-color-dark:#059669}.chapter-option[data-color=yellow]{--option-color:#f59e0b;--option-color-dark:#d97706}.chapter-option[data-color=red]{--option-color:#ef4444;--option-color-dark:#dc2626}.chapter-option[data-color=blue]{--option-color:#3b82f6;--option-color-dark:#2563eb}.chapter-option[data-color=purple]{--option-color:#8b5cf6;--option-color-dark:#7c3aed}.chapter-option[data-color=orange]{--option-color:#f97316;--option-color-dark:#ea580c}.chapter-option[data-color=teal]{--option-color:#14b8a6;--option-color-dark:#0d9488}.chapter-option[data-color=indigo]{--option-color:#6366f1;--option-color-dark:#4f46e5}.chapter-option[data-color=pink]{--option-color:#ec4899;--option-color-dark:#db2777}.chapter-option[data-color=cyan]{--option-color:#06b6d4;--option-color-dark:#0891b2}@media(max-width:768px){.chapter-navigation{padding:1rem}.chapter-option{padding:1rem}.chapter-option-content{margin-left:2.5rem}.chapter-option-footer{flex-direction:column;align-items:flex-start;gap:.75rem}.chapter-option-link{align-self:stretch;justify-content:center}}</style></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/chapitres/fondamentaux/chapitre-01-introduction-event-storming-ddd/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Chapitre 1 : Introduction au Domain-Driven Design et Event Storming</p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>© 2025 Grégory Planchat. Tous droits réservés.</p></div></div></div><div class="row mt-3 pt-3 border-top"><div class=col-12><div class=text-center><h6 class="text-muted mb-2">Nos Sponsors</h6><p class="text-muted small mb-2">Merci à nos partenaires qui soutiennent cette initiative</p><div class="d-flex justify-content-center align-items-center flex-wrap gap-2"><div class=sponsor-item><a href=https://kiboko.fr target=_blank rel="noopener noreferrer" class=text-decoration-none><span class="badge bg-light text-dark border px-2 py-1 small">Kiboko</span></a></div><div class=sponsor-item><a href=https://gyroscops.com target=_blank rel="noopener noreferrer" class=text-decoration-none><span class="badge bg-light text-dark border px-2 py-1 small">Gyroscops</span></a></div></div></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script src=/docs/js/bootstrap.c7927bdd82eceb076739257add3f4b0e11379da037c07d5c7110daeb6de0e3edcb2de867604550f88815157e4ec4ddb7.js integrity=sha384-x5J73YLs6wdnOSV63T9LDhE3naA3wH1ccRDa623g4+3LLehnYEVQ+IgVFX5OxN23 defer></script><script type=text/javascript src=http://localhost:1313/docs/js/bundle.min.a046e72674401a45bf99217648934a99ff03a7c46d105e47916156e66969388a0643f55a1e850acb495c9bd8be985171.js integrity=sha384-oEbnJnRAGkW/mSF2SJNKmf8Dp8RtEF5HkWFW5mlpOIoGQ/VaHoUKy0lcm9i+mFFx crossorigin=anonymous defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    


    

    

    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>