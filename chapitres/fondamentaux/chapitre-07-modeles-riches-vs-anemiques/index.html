<!doctype html><html lang=fr-fr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><title>Chapitre 7 : Modèles Riches vs Modèles Anémiques | DDD Adventure</title><meta name=robots content="noindex"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comparaison détaillée avec exemples de code pour comprendre la différence entre modèles riches et anémiques"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=http://localhost:1313/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=http://localhost:1313/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=http://localhost:1313/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=http://localhost:1313/site.webmanifest><meta property="og:title" content="Chapitre 7 : Modèles Riches vs Modèles Anémiques"><meta property="og:description" content="Comparaison détaillée avec exemples de code pour comprendre la différence entre modèles riches et anémiques"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/chapitres/fondamentaux/chapitre-07-modeles-riches-vs-anemiques/"><meta property="og:image" content="http://localhost:1313/opengraph/card-base-2_hu_b8ee13f8b3206735.png"><meta property="article:section" content="chapitres"><meta property="article:published_time" content="2024-12-19T00:00:00+00:00"><meta property="article:modified_time" content="2024-12-19T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/opengraph/card-base-2_hu_b8ee13f8b3206735.png"><meta name=twitter:title content="Chapitre 7 : Modèles Riches vs Modèles Anémiques"><meta name=twitter:description content="Comparaison détaillée avec exemples de code pour comprendre la différence entre modèles riches et anémiques"><link rel=alternate type=application/atom+xml title="Atom feed for DDD Adventure" href=/index.xml><script type=text/javascript src=http://localhost:1313/docs/js/flexsearch.bundle.js></script><link rel=stylesheet href=/docs/scss/style.css crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li class="sidebar-dropdown no-icon current active"><button class=btn>
Chapitres Fondamentaux</button><div class="sidebar-submenu d-block"><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-01-introduction-event-storming-ddd/>Chapitre 1 : Introduction au Domain-Driven Design et Event Storming</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-02-impact-mapping/>Chapitre 2 : L'Impact Mapping - Aligner le Produit sur les Objectifs Business</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-03-atelier-event-storming/>Chapitre 3 : L'Atelier Event Storming - Guide Pratique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-04-example-mapping/>Chapitre 4 : L'Example Mapping - Détailer les Règles Métier</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-05-complexite-accidentelle-essentielle/>Chapitre 5 : Complexité Accidentelle vs Essentielle - Le Choix Architectural</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-06-granularite-choix-architecturaux/>Chapitre 6 : Granularité des Choix Architecturaux</a></li><li class="current no-icon"><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-07-modeles-riches-vs-anemiques/>Chapitre 7 : Modèles Riches vs Modèles Anémiques</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-08-architecture-evenementielle/>Chapitre 8 : Architecture Événementielle</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-09-repositories-persistance/>Chapitre 9 : Repositories et Persistance</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/fondamentaux/chapitre-10-choix-type-stockage/>Chapitre 15 : Choix du Type de Stockage</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres Optionnels</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-13-architecture-cqrs/>Chapitre 15 : Architecture CQRS avec API Platform</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-12-architecture-cqs/>Chapitre 15 : Architecture CQS - Command Query Separation</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-11-event-sourcing/>Chapitre 15 : Event Sourcing - La Source de Vérité</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-14-cqrs-event-sourcing-combines/>Chapitre 15 : CQRS + Event Sourcing Combinés</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/optionnels/chapitre-15-projections-event-sourcing/>Chapitre 15 : Projections Event Sourcing</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres de Stockage</button><div class=sidebar-submenu><ul><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage SQL</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-16-stockage-sql-classique/>Chapitre 16 : Stockage SQL - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-17-stockage-sql-cqs/>Chapitre 17 : Stockage SQL - Approche CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-18-stockage-sql-cqrs/>Chapitre 18 : Stockage SQL - Approche CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-19-stockage-sql-event-sourcing/>Chapitre 19 : Stockage SQL - Event Sourcing Seul</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-20-stockage-sql-event-sourcing-cqs/>Chapitre 58 : Stockage SQL - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/sql/chapitre-21-stockage-sql-event-sourcing-cqrs/>Chapitre 59 : Stockage SQL - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage API</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-26-stockage-api-event-sourcing-cqs/>Chapitre 26 : Stockage API - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-27-stockage-api-event-sourcing-cqrs/>Chapitre 27 : Stockage API - Event Sourcing + CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-22-stockage-api-classique/>Chapitre 60 : Stockage API - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-23-stockage-api-cqs/>Chapitre 61 : Stockage API - Approche CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-24-stockage-api-cqrs/>Chapitre 62 : Stockage API - Approche CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/api/chapitre-25-stockage-api-event-sourcing/>Chapitre 63 : Stockage API - Event Sourcing Seul</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage MongoDB</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-28-stockage-mongodb-classique/>Chapitre 28 : Stockage MongoDB - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-29-stockage-mongodb-cqs/>Chapitre 29 : Stockage MongoDB - Approche CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-30-stockage-mongodb-cqrs/>Chapitre 30 : Stockage MongoDB - Approche CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-31-stockage-mongodb-event-sourcing/>Chapitre 31 : Stockage MongoDB - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-32-stockage-mongodb-event-sourcing-cqs/>Stockage MongoDB - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/mongodb/chapitre-33-stockage-mongodb-event-sourcing-cqrs/>Stockage MongoDB - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage ElasticSearch</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-34-stockage-elasticsearch-classique/>Stockage ElasticSearch - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-35-stockage-elasticsearch-cqs/>Stockage ElasticSearch - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-36-stockage-elasticsearch-cqrs/>Stockage ElasticSearch - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-37-stockage-elasticsearch-event-sourcing/>Stockage ElasticSearch - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-38-stockage-elasticsearch-event-sourcing-cqs/>Stockage ElasticSearch - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/elasticsearch/chapitre-39-stockage-elasticsearch-event-sourcing-cqrs/>Stockage ElasticSearch - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage In-Memory</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-40-stockage-in-memory-classique/>Stockage In-Memory - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-41-stockage-in-memory-cqs/>Stockage In-Memory - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-42-stockage-in-memory-cqrs/>Stockage In-Memory - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-43-stockage-in-memory-event-sourcing/>Stockage In-Memory - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-44-stockage-in-memory-event-sourcing-cqs/>Stockage In-Memory - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/in-memory/chapitre-45-stockage-in-memory-event-sourcing-cqrs/>Stockage In-Memory - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage Composite piloté par Temporal</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-46-stockage-temporal-classique/>Stockage Temporal - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-47-stockage-temporal-cqs/>Stockage Temporal - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-48-stockage-temporal-cqrs/>Stockage Temporal - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-49-stockage-temporal-event-sourcing/>Stockage Temporal - Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-50-stockage-temporal-event-sourcing-cqs/>Stockage Temporal - Event Sourcing + CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/temporal/chapitre-51-stockage-temporal-event-sourcing-cqrs/>Stockage Temporal - Event Sourcing + CQRS</a></li></ul></div></li><li class="sidebar-dropdown nested no-icon"><button class=btn>
Stockage Multi-sources</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-52-stockage-multi-sources-classique/>Stockage Multi-sources - Approche Classique</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-53-stockage-multi-sources-cqs/>Stockage Multi-sources - CQS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-54-stockage-multi-sources-cqrs/>Stockage Multi-sources - CQRS</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-55-stockage-multi-sources-event-sourcing/>Stockage Multi-sources avec Event Sourcing</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-56-stockage-multi-sources-strategies-avancees/>Stratégies Avancées de Réplication Multi-sources</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/stockage/multi-sources/chapitre-57-stockage-multi-sources-resolution-conflits/>Résolution de Conflits Multi-sources</a></li></ul></div></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres Techniques</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-58-gestion-donnees-validation/>Chapitre 58 : Gestion des Données et Validation</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-59-pagination-performance/>Chapitre 59 : Pagination et Performance</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-60-gestion-erreurs-observabilite/>Chapitre 60 : Gestion d'Erreurs et Observabilité</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/techniques/chapitre-61-tests-qualite/>Chapitre 61 : Tests et Qualité</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Chapitres Avancés</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/avances/chapitre-62-securite-autorisation/>Chapitre 62 : Sécurité et Autorisation - Protéger votre API Platform</a></li><li class=no-icon><a class=sidebar-nested-link href=http://localhost:1313/chapitres/avances/chapitre-63-frontend-integration/>Chapitre 63 : Frontend et Intégration - Connecter votre Interface Utilisateur</a></li></ul></div></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentColor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentColor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentColor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentColor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentColor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentColor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentColor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://twitter.com/gplanchat alt=twitter rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24"><title>Twitter / X</title><path d="M.088.768l9.266 12.39L.029 23.231h2.1l8.163-8.819 6.6 8.819h7.142L14.242 10.145 22.921.768h-2.1L13.3 8.891 7.229.768zM3.174 2.314H6.455L20.942 21.685h-3.28z" fill="currentColor"/></svg></div></a></li></ul></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/chapitres/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/chapitres/fondamentaux/><span itemprop=name>Chapitres Fondamentaux</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Chapitre 7 : Modèles Riches vs Modèles Anémiques</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=TableOfContents><ul><li><a href=#-objectif-de-ce-chapitre>🎯 Objectif de ce Chapitre</a><ul><li><a href=#références-aux-adr-du-projet-gyroscops-cloud>Références aux ADR du projet Gyroscops Cloud</a></li></ul></li><li><a href=#-le-problème-des-modèles-anémiques>🚨 Le Problème des Modèles Anémiques</a><ul><li><a href=#quest-ce-quun-modèle-anémique->Qu&rsquo;est-ce qu&rsquo;un Modèle Anémique ?</a></li><li><a href=#pourquoi-cest-problématique->Pourquoi c&rsquo;est Problématique ?</a></li><li><a href=#exemple-concret--gestion-des-paiements>Exemple Concret : Gestion des Paiements</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--modèle-anémique>Exemple du projet Gyroscops Cloud : Modèle Anémique</a></li></ul></li><li><a href=#-la-solution--modèles-riches>✅ La Solution : Modèles Riches</a><ul><li><a href=#principe-fondamental>Principe Fondamental</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--modèle-riche>Exemple du projet Gyroscops Cloud : Modèle Riche</a></li><li><a href=#avantages-du-modèle-riche>Avantages du Modèle Riche</a></li></ul></li><li><a href=#patterns-de-modèles-riches>Patterns de Modèles Riches</a><ul><li><a href=#1-constructeurs-privés-avec-méthodes-statiques>1. Constructeurs Privés avec Méthodes Statiques</a></li><li><a href=#2-objets-de-valeur-pour-les-propriétés-complexes>2. Objets de Valeur pour les Propriétés Complexes</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--value-object-price>Exemple du projet Gyroscops Cloud : Value Object Price</a></li><li><a href=#3-énumérations-pour-les-états>3. Énumérations pour les États</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--énumération-statuses>Exemple du projet Gyroscops Cloud : Énumération Statuses</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--énumération-recurrences>Exemple du projet Gyroscops Cloud : Énumération Recurrences</a></li><li><a href=#4-méthodes-métier-expressives>4. Méthodes Métier Expressives</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--identifiants-value-objects>Exemple du projet Gyroscops Cloud : Identifiants Value Objects</a></li><li><a href=#-références-aux-adr-du-projet-gyroscops-cloud>📚 Références aux ADR du projet Gyroscops Cloud</a></li></ul></li><li><a href=#transformation-dun-modèle-anémique>Transformation d&rsquo;un Modèle Anémique</a><ul><li><a href=#avant--modèle-anémique>Avant : Modèle Anémique</a></li><li><a href=#après--modèle-riche>Après : Modèle Riche</a></li></ul></li><li><a href=#-tests-des-modèles-riches>🧪 Tests des Modèles Riches</a><ul><li><a href=#tests-unitaires-simplifiés>Tests Unitaires Simplifiés</a></li></ul></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#-objectif-de-ce-chapitre>🎯 Objectif de ce Chapitre</a><ul><li><a href=#références-aux-adr-du-projet-gyroscops-cloud>Références aux ADR du projet Gyroscops Cloud</a></li></ul></li><li><a href=#-le-problème-des-modèles-anémiques>🚨 Le Problème des Modèles Anémiques</a><ul><li><a href=#quest-ce-quun-modèle-anémique->Qu&rsquo;est-ce qu&rsquo;un Modèle Anémique ?</a></li><li><a href=#pourquoi-cest-problématique->Pourquoi c&rsquo;est Problématique ?</a></li><li><a href=#exemple-concret--gestion-des-paiements>Exemple Concret : Gestion des Paiements</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--modèle-anémique>Exemple du projet Gyroscops Cloud : Modèle Anémique</a></li></ul></li><li><a href=#-la-solution--modèles-riches>✅ La Solution : Modèles Riches</a><ul><li><a href=#principe-fondamental>Principe Fondamental</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--modèle-riche>Exemple du projet Gyroscops Cloud : Modèle Riche</a></li><li><a href=#avantages-du-modèle-riche>Avantages du Modèle Riche</a></li></ul></li><li><a href=#patterns-de-modèles-riches>Patterns de Modèles Riches</a><ul><li><a href=#1-constructeurs-privés-avec-méthodes-statiques>1. Constructeurs Privés avec Méthodes Statiques</a></li><li><a href=#2-objets-de-valeur-pour-les-propriétés-complexes>2. Objets de Valeur pour les Propriétés Complexes</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--value-object-price>Exemple du projet Gyroscops Cloud : Value Object Price</a></li><li><a href=#3-énumérations-pour-les-états>3. Énumérations pour les États</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--énumération-statuses>Exemple du projet Gyroscops Cloud : Énumération Statuses</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--énumération-recurrences>Exemple du projet Gyroscops Cloud : Énumération Recurrences</a></li><li><a href=#4-méthodes-métier-expressives>4. Méthodes Métier Expressives</a></li><li><a href=#exemple-du-projet-gyroscops-cloud--identifiants-value-objects>Exemple du projet Gyroscops Cloud : Identifiants Value Objects</a></li><li><a href=#-références-aux-adr-du-projet-gyroscops-cloud>📚 Références aux ADR du projet Gyroscops Cloud</a></li></ul></li><li><a href=#transformation-dun-modèle-anémique>Transformation d&rsquo;un Modèle Anémique</a><ul><li><a href=#avant--modèle-anémique>Avant : Modèle Anémique</a></li><li><a href=#après--modèle-riche>Après : Modèle Riche</a></li></ul></li><li><a href=#-tests-des-modèles-riches>🧪 Tests des Modèles Riches</a><ul><li><a href=#tests-unitaires-simplifiés>Tests Unitaires Simplifiés</a></li></ul></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><h1 class="content-title mb-0">Chapitre 7 : Modèles Riches vs Modèles Anémiques
<span class="badge bg-default fs-6 mb-1 align-middle">DRAFT</span></h1></div><div id=content class=main-content><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h2 id=-objectif-de-ce-chapitre>🎯 Objectif de ce Chapitre <a href=#-objectif-de-ce-chapitre class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>Ce chapitre vous montre concrètement la différence entre modèles riches et anémiques avec des exemples de code du projet Gyroscops Cloud. Vous apprendrez :</p><ul><li>Comment identifier un modèle anémique</li><li>Comment transformer un modèle anémique en modèle riche</li><li>Les patterns de modèles riches</li><li>La conservation de l&rsquo;intention métier</li></ul><h3 id=références-aux-adr-du-projet-gyroscops-cloud>Références aux ADR du projet Gyroscops Cloud <a href=#r%c3%a9f%c3%a9rences-aux-adr-du-projet-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Ce chapitre s&rsquo;appuie sur les Architecture Decision Records (ADR) suivants du projet Gyroscops Cloud :</p><ul><li><strong>HIVE040</strong> : Enhanced Models with Property Access Patterns - Patterns d&rsquo;accès aux propriétés des modèles</li><li><strong>HIVE041</strong> : Cross-Cutting Concerns Architecture - Architecture des préoccupations transversales</li><li><strong>HIVE005</strong> : Common Identifier Model Interfaces - Interfaces standardisées pour les identifiants</li><li><strong>HIVE027</strong> : PHPUnit Testing Standards - Standards de test pour valider les modèles riches</li></ul><h2 id=-le-problème-des-modèles-anémiques>🚨 Le Problème des Modèles Anémiques <a href=#-le-probl%c3%a8me-des-mod%c3%a8les-an%c3%a9miques class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=quest-ce-quun-modèle-anémique->Qu&rsquo;est-ce qu&rsquo;un Modèle Anémique ? <a href=#quest-ce-quun-mod%c3%a8le-an%c3%a9mique- class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Un modèle anémique est un modèle de données qui ne contient que des propriétés (getters/setters) sans logique métier. Toute la logique est déplacée dans des services externes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ❌ Modèle Anémique - Exemple typique
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $id,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $email,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $firstName,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $lastName,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>bool</span> $isActive <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Seulement des getters/setters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getId</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>id</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getEmail</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>email</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setEmail</span>(<span style=color:#a6e22e>string</span> $email)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>email</span> <span style=color:#f92672>=</span> $email; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getFirstName</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>firstName</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setFirstName</span>(<span style=color:#a6e22e>string</span> $firstName)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>firstName</span> <span style=color:#f92672>=</span> $firstName; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getLastName</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lastName</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setLastName</span>(<span style=color:#a6e22e>string</span> $lastName)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lastName</span> <span style=color:#f92672>=</span> $lastName; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isActive</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isActive</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setIsActive</span>(<span style=color:#a6e22e>bool</span> $isActive)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isActive</span> <span style=color:#f92672>=</span> $isActive; }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=pourquoi-cest-problématique->Pourquoi c&rsquo;est Problématique ? <a href=#pourquoi-cest-probl%c3%a9matique- class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><ol><li><strong>Perte de l&rsquo;Intention Métier</strong> : Le code ne reflète plus les règles métier</li><li><strong>Violation du Principe DRY</strong> : La logique est dupliquée dans les services</li><li><strong>Difficile à Tester</strong> : Les règles métier sont éparpillées</li><li><strong>Évolution Complexe</strong> : Changer une règle métier nécessite de modifier plusieurs endroits</li></ol><h3 id=exemple-concret--gestion-des-paiements>Exemple Concret : Gestion des Paiements <a href=#exemple-concret--gestion-des-paiements class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ❌ Approche Anémique
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PaymentService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>processPayment</span>(<span style=color:#a6e22e>Payment</span> $payment, <span style=color:#a6e22e>float</span> $amount)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Logique métier dans le service
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> ($amount <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidArgumentException</span>(<span style=color:#e6db74>&#39;Amount must be positive&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getStatus</span>() <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;pending&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidStateException</span>(<span style=color:#e6db74>&#39;Payment already processed&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($amount <span style=color:#f92672>&gt;</span> $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getMaxAmount</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BusinessRuleException</span>(<span style=color:#e6db74>&#39;Amount exceeds maximum&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Plus de logique métier...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setStatus</span>(<span style=color:#e6db74>&#39;processed&#39;</span>);
</span></span><span style=display:flex><span>        $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setProcessedAt</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DateTime</span>());
</span></span><span style=display:flex><span>        $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setAmount</span>($amount);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=exemple-du-projet-gyroscops-cloud--modèle-anémique>Exemple du projet Gyroscops Cloud : Modèle Anémique <a href=#exemple-du-projet-gyroscops-cloud--mod%c3%a8le-an%c3%a9mique class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Voici un exemple réel d&rsquo;un modèle anémique que l&rsquo;on pourrait trouver dans le projet Gyroscops Cloud :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ❌ Modèle Anémique - Exemple typique (projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Payment</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $id,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $amount,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $currency,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $status,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>string</span> $processedAt <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Seulement des getters/setters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getId</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>id</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getAmount</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setAmount</span>(<span style=color:#a6e22e>string</span> $amount)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span> <span style=color:#f92672>=</span> $amount; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getCurrency</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setCurrency</span>(<span style=color:#a6e22e>string</span> $currency)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span> <span style=color:#f92672>=</span> $currency; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getStatus</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setStatus</span>(<span style=color:#a6e22e>string</span> $status)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>=</span> $status; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getProcessedAt</span>()<span style=color:#f92672>:</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>processedAt</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setProcessedAt</span>(<span style=color:#f92672>?</span><span style=color:#a6e22e>string</span> $processedAt)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>processedAt</span> <span style=color:#f92672>=</span> $processedAt; }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Problèmes identifiés</strong> :</p><ul><li><strong>Violation de HIVE040</strong> : Pas de patterns d&rsquo;accès aux propriétés appropriés</li><li><strong>Violation de HIVE041</strong> : Mélange de responsabilités (données + logique métier)</li><li><strong>Violation de HIVE005</strong> : Pas d&rsquo;interface standardisée pour les identifiants</li><li><strong>Difficile à tester</strong> : Logique métier éparpillée dans les services</li></ul><h2 id=-la-solution--modèles-riches>✅ La Solution : Modèles Riches <a href=#-la-solution--mod%c3%a8les-riches class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=principe-fondamental>Principe Fondamental <a href=#principe-fondamental class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Le DDD place la logique métier au cœur du modèle, dans les entités et objets de valeur.</p><h3 id=exemple-du-projet-gyroscops-cloud--modèle-riche>Exemple du projet Gyroscops Cloud : Modèle Riche <a href=#exemple-du-projet-gyroscops-cloud--mod%c3%a8le-riche class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Voici un exemple réel de modèle riche du projet Gyroscops Cloud, respectant les ADR :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Modèle Riche - Approche DDD (projet Gyroscops Cloud)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Payment</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>PaymentId</span> $uuid,                    <span style=color:#75715e>// HIVE005 : Interface standardisée
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>RealmId</span> $realmId,                   <span style=color:#75715e>// HIVE005 : Interface standardisée
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>OrganizationId</span> $organizationId,     <span style=color:#75715e>// HIVE005 : Interface standardisée
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>readonly</span> <span style=color:#a6e22e>SubscriptionId</span> $subscriptionId,     <span style=color:#75715e>// HIVE005 : Interface standardisée
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>\DateTimeInterface</span> $creationDate <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>\DateTimeInterface</span> $expirationDate <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>\DateTimeInterface</span> $completionDate <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Statuses</span> $status <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Gateways</span> $gateway <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Price</span> $subtotal <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Price</span> $discount <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Price</span> $taxes <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Price</span> $total <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>Price</span> $captured <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>array</span> $events <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>int</span> $version <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>registerManualPayment</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PaymentId</span> $uuid,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>RealmId</span> $realmId,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>OrganizationId</span> $organizationId,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>SubscriptionId</span> $subscriptionId,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>\DateTimeInterface</span> $creationDate,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>\DateTimeInterface</span> $expirationDate,
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span><span style=color:#a6e22e>\DateTimeInterface</span> $completionDate,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>string</span> $customerName,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>string</span> $customerEmail,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Statuses</span> $status,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Price</span> $subtotal,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Price</span> $discount,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Price</span> $vat,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Price</span> $total,
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span> {
</span></span><span style=display:flex><span>        $instance <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($uuid, $realmId, $organizationId, $subscriptionId);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $instance<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>recordThat</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>RegisteredPaymentEvent</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>uuid</span><span style=color:#f92672>:</span> $uuid,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>realmId</span><span style=color:#f92672>:</span> $realmId,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>organizationId</span><span style=color:#f92672>:</span> $organizationId,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>subscriptionId</span><span style=color:#f92672>:</span> $subscriptionId,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>creationDate</span><span style=color:#f92672>:</span> $creationDate,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>expirationDate</span><span style=color:#f92672>:</span> $expirationDate,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>completionDate</span><span style=color:#f92672>:</span> $completionDate,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>customerName</span><span style=color:#f92672>:</span> $customerName,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>customerEmail</span><span style=color:#f92672>:</span> $customerEmail,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> $status,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>gateway</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Gateways</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Manual</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>subtotal</span><span style=color:#f92672>:</span> $subtotal,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>discount</span><span style=color:#f92672>:</span> $discount,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>taxes</span><span style=color:#f92672>:</span> $vat,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>total</span><span style=color:#f92672>:</span> $total,
</span></span><span style=display:flex><span>        ));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $instance;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>capture</span>(<span style=color:#a6e22e>Price</span> $amount)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>recordThat</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CapturedEvent</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>uuid</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>uuid</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>version</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>realmId</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>realmId</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>organizationId</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>organizationId</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>subscriptionId</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>subscriptionId</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Completed</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>gateway</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>gateway</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>subtotal</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>subtotal</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>discount</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>discount</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>taxes</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>taxes</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>total</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>total</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>completionDate</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DateTimeImmutable</span>(),
</span></span><span style=display:flex><span>        ));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fail</span>(<span style=color:#a6e22e>string</span> $reason)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>recordThat</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FailedEvent</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>uuid</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>uuid</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>version</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>realmId</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>realmId</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>organizationId</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>organizationId</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>subscriptionId</span><span style=color:#f92672>:</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>subscriptionId</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Failed</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>reason</span><span style=color:#f92672>:</span> $reason,
</span></span><span style=display:flex><span>        ));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>canTransitionTo</span>(<span style=color:#a6e22e>Statuses</span> $status)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>match</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Pending</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>match</span> ($status) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Pending</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Authorized</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Completed</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Cancelled</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Failed</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Authorized</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>match</span> ($status) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Authorized</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Completed</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Cancelled</span>, <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Failed</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>default</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Completed</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>match</span> ($status) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Completed</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>default</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Cancelled</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>match</span> ($status) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Cancelled</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>default</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Failed</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>match</span> ($status) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Failed</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>default</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Conformité aux ADR</strong> :</p><ul><li><strong>HIVE040</strong> : Utilisation de propriétés publiques en lecture seule (<code>public readonly</code>)</li><li><strong>HIVE041</strong> : Séparation claire des responsabilités (logique métier dans l&rsquo;agrégat)</li><li><strong>HIVE005</strong> : Utilisation d&rsquo;interfaces standardisées pour les identifiants</li><li><strong>Event Sourcing</strong> : Chaque changement d&rsquo;état est enregistré comme un événement</li><li><strong>Protection des invariants</strong> : <code>canTransitionTo()</code> protège les transitions d&rsquo;état valides</li></ul><h3 id=avantages-du-modèle-riche>Avantages du Modèle Riche <a href=#avantages-du-mod%c3%a8le-riche class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><ol><li><strong>Intention Métier Préservée</strong> : Le code reflète les règles métier</li><li><strong>Cohérence</strong> : Les règles sont centralisées dans le modèle</li><li><strong>Testabilité</strong> : Facile de tester les règles métier</li><li><strong>Évolutivité</strong> : Changer une règle ne nécessite qu&rsquo;une modification</li></ol><h2 id=patterns-de-modèles-riches>Patterns de Modèles Riches <a href=#patterns-de-mod%c3%a8les-riches class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=1-constructeurs-privés-avec-méthodes-statiques>1. Constructeurs Privés avec Méthodes Statiques <a href=#1-constructeurs-priv%c3%a9s-avec-m%c3%a9thodes-statiques class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>UserId</span> $id,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Email</span> $email,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>UserName</span> $name,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>UserStatus</span> $status
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>create</span>(<span style=color:#a6e22e>UserId</span> $id, <span style=color:#a6e22e>Email</span> $email, <span style=color:#a6e22e>UserName</span> $name)<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($id, $email, $name, <span style=color:#a6e22e>UserStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>ACTIVE</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fromExisting</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>UserId</span> $id,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Email</span> $email,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>UserName</span> $name,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>UserStatus</span> $status
</span></span><span style=display:flex><span>    )<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($id, $email, $name, $status);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=2-objets-de-valeur-pour-les-propriétés-complexes>2. Objets de Valeur pour les Propriétés Complexes <a href=#2-objets-de-valeur-pour-les-propri%c3%a9t%c3%a9s-complexes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Money</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>float</span> $amount,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Currency</span> $currency
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($amount <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidArgumentException</span>(<span style=color:#e6db74>&#39;Amount cannot be negative&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>Money</span> $other)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Money</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>equals</span>($other<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CurrencyMismatchException</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Money</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span> <span style=color:#f92672>+</span> $other<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>multiply</span>(<span style=color:#a6e22e>float</span> $factor)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Money</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Money</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span> <span style=color:#f92672>*</span> $factor, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isGreaterThan</span>(<span style=color:#a6e22e>Money</span> $other)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>equals</span>($other<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CurrencyMismatchException</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span> <span style=color:#f92672>&gt;</span> $other<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=exemple-du-projet-gyroscops-cloud--value-object-price>Exemple du projet Gyroscops Cloud : Value Object Price <a href=#exemple-du-projet-gyroscops-cloud--value-object-price class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Voici un exemple réel de Value Object du projet Gyroscops Cloud :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Value Object Price - projet Gyroscops Cloud
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#a6e22e>readonly</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Price</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>BigDecimal</span> $amount,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Currencies</span> $currency,
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Assertion</span><span style=color:#f92672>::</span><span style=color:#a6e22e>true</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isGreaterThanOrEqualTo</span>(<span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>substract</span>(<span style=color:#a6e22e>self</span> $price)<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span> <span style=color:#f92672>!==</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DomainException</span>(<span style=color:#e6db74>&#39;Currency conversion is not supported&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>minus</span>($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>), $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>self</span> $price)<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span> <span style=color:#f92672>!==</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DomainException</span>(<span style=color:#e6db74>&#39;Currency conversion is not supported&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>plus</span>($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>), $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isGreaterThan</span>(<span style=color:#a6e22e>self</span> $price)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span> <span style=color:#f92672>!==</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DomainException</span>(<span style=color:#e6db74>&#39;Currency conversion is not supported&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isGreaterThan</span>($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isGreaterThanOrEqualTo</span>(<span style=color:#a6e22e>self</span> $price)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span> <span style=color:#f92672>!==</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>currency</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DomainException</span>(<span style=color:#e6db74>&#39;Currency conversion is not supported&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isGreaterThanOrEqualTo</span>($price<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>amount</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Caractéristiques de ce Value Object :</strong></p><ul><li><strong>Immuable</strong> : <code>readonly</code> class</li><li><strong>Validation</strong> : Vérification que le montant est positif</li><li><strong>Logique métier</strong> : Opérations arithmétiques avec validation des devises</li><li><strong>Type safety</strong> : Utilisation de <code>BigDecimal</code> pour la précision</li><li><strong>Exceptions métier</strong> : Messages d&rsquo;erreur explicites</li></ul><h3 id=3-énumérations-pour-les-états>3. Énumérations pour les États <a href=#3-%c3%a9num%c3%a9rations-pour-les-%c3%a9tats class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>enum</span> <span style=color:#a6e22e>PaymentStatus</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>PENDING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;pending&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>PROCESSED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;processed&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>FAILED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;failed&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>REFUNDED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;refunded&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>canTransitionTo</span>(<span style=color:#a6e22e>PaymentStatus</span> $newStatus)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>match</span> ($this) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PENDING</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>in_array</span>($newStatus, [<span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PROCESSED</span>, <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>FAILED</span>]),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PROCESSED</span> <span style=color:#f92672>=&gt;</span> $newStatus <span style=color:#f92672>===</span> <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>REFUNDED</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>FAILED</span> <span style=color:#f92672>=&gt;</span> $newStatus <span style=color:#f92672>===</span> <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PENDING</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>REFUNDED</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=exemple-du-projet-gyroscops-cloud--énumération-statuses>Exemple du projet Gyroscops Cloud : Énumération Statuses <a href=#exemple-du-projet-gyroscops-cloud--%c3%a9num%c3%a9ration-statuses class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Voici un exemple réel d&rsquo;énumération du projet Gyroscops Cloud :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Énumération Statuses - projet Gyroscops Cloud
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>enum</span> <span style=color:#a6e22e>Statuses</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Pending</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Pending&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Active</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Active&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Cancelled</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Cancelled&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Suspended</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Suspended&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Expired</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Expired&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Declined</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Declined&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isEnabled</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Active</span> <span style=color:#f92672>===</span> $this <span style=color:#f92672>||</span> <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Cancelled</span> <span style=color:#f92672>===</span> $this;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isPending</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Pending</span> <span style=color:#f92672>===</span> $this;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Caractéristiques de cette énumération :</strong></p><ul><li><strong>Logique métier</strong> : Méthodes <code>isEnabled()</code> et <code>isPending()</code></li><li><strong>Type safety</strong> : Utilisation d&rsquo;énumérations PHP 8.1+</li><li><strong>Lisibilité</strong> : Noms explicites pour chaque état</li><li><strong>Encapsulation</strong> : Logique métier dans l&rsquo;énumération</li></ul><h3 id=exemple-du-projet-gyroscops-cloud--énumération-recurrences>Exemple du projet Gyroscops Cloud : Énumération Recurrences <a href=#exemple-du-projet-gyroscops-cloud--%c3%a9num%c3%a9ration-recurrences class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Énumération Recurrences - projet Gyroscops Cloud
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>enum</span> <span style=color:#a6e22e>Recurrences</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Once</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Once&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Monthly</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Monthly&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Quarterly</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Quarterly&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Biannually</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Biannually&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Yearly</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Yearly&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>nextPaymentTerm</span>(<span style=color:#a6e22e>\DateTimeInterface</span> $lastPaymentDate)<span style=color:#f92672>:</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>\DateTimeInterface</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $lastPaymentDate <span style=color:#f92672>=</span> <span style=color:#a6e22e>\DateTimeImmutable</span><span style=color:#f92672>::</span><span style=color:#a6e22e>createFromInterface</span>($lastPaymentDate);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>match</span> ($this) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Recurrences</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Once</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Recurrences</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Monthly</span> <span style=color:#f92672>=&gt;</span> $lastPaymentDate<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DateInterval</span>(<span style=color:#e6db74>&#39;P1M&#39;</span>)),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Recurrences</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Quarterly</span> <span style=color:#f92672>=&gt;</span> $lastPaymentDate<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DateInterval</span>(<span style=color:#e6db74>&#39;P3M&#39;</span>)),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Recurrences</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Biannually</span> <span style=color:#f92672>=&gt;</span> $lastPaymentDate<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DateInterval</span>(<span style=color:#e6db74>&#39;P6M&#39;</span>)),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Recurrences</span><span style=color:#f92672>::</span><span style=color:#a6e22e>Yearly</span> <span style=color:#f92672>=&gt;</span> $lastPaymentDate<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>\DateInterval</span>(<span style=color:#e6db74>&#39;P1Y&#39;</span>)),
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Caractéristiques de cette énumération :</strong></p><ul><li><strong>Logique métier complexe</strong> : Calcul de la prochaine échéance</li><li><strong>Pattern matching</strong> : Utilisation de <code>match</code> pour la logique</li><li><strong>Immutabilité</strong> : Retour d&rsquo;un nouvel objet <code>DateTimeImmutable</code></li><li><strong>Null safety</strong> : Retour de <code>null</code> pour les paiements uniques</li></ul><h3 id=4-méthodes-métier-expressives>4. Méthodes Métier Expressives <a href=#4-m%c3%a9thodes-m%c3%a9tier-expressives class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Subscription</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>renew</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>canBeRenewed</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SubscriptionCannotBeRenewedException</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>SubscriptionStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>ACTIVE</span>;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>renewedAt</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DateTime</span>();
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expiresAt</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>calculateNewExpirationDate</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>cancel</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>canBeCancelled</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SubscriptionCannotBeCancelledException</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>SubscriptionStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>CANCELLED</span>;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cancelledAt</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DateTime</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>canBeRenewed</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>SubscriptionStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EXPIRED</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&amp;&amp;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isNotInGracePeriod</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>canBeCancelled</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>SubscriptionStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>ACTIVE</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isInGracePeriod</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=exemple-du-projet-gyroscops-cloud--identifiants-value-objects>Exemple du projet Gyroscops Cloud : Identifiants Value Objects <a href=#exemple-du-projet-gyroscops-cloud--identifiants-value-objects class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Voici un exemple réel d&rsquo;identifiant du projet Gyroscops Cloud :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Identifiant UserId - projet Gyroscops Cloud
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>final</span> <span style=color:#a6e22e>readonly</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserId</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>UuidInterface</span>, <span style=color:#a6e22e>LocatableInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> <span style=color:#a6e22e>REQUIREMENT</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Requirement</span><span style=color:#f92672>::</span><span style=color:#a6e22e>UUID_V7</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> <span style=color:#a6e22e>URI_REQUIREMENT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\/authentication\/users\/(&#39;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Requirement</span><span style=color:#f92672>::</span><span style=color:#a6e22e>UUID_V7</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;)&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> <span style=color:#a6e22e>URI_PARSE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/^\/authentication\/users\/(?&lt;reference&gt;&#39;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Requirement</span><span style=color:#f92672>::</span><span style=color:#a6e22e>UUID</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;)$/&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $reference,
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>uuid_is_valid</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reference</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidUuidFormatException</span>(<span style=color:#a6e22e>\sprintf</span>(<span style=color:#e6db74>&#39;&lt;%s&gt; is not a valid UUID.&#39;</span>, $reference));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>generateRandom</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>(<span style=color:#a6e22e>UuidV7</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>nil</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>(<span style=color:#a6e22e>uuid_create</span>(<span style=color:#a6e22e>UUID_TYPE_NULL</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fromUri</span>(<span style=color:#a6e22e>string</span> $uri)<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>URI_PARSE</span>, $uri, $matches)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidUriFormatException</span>(<span style=color:#a6e22e>\sprintf</span>(<span style=color:#e6db74>&#39;&lt;%s&gt; is not a valid URI.&#39;</span>, $uri));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($matches[<span style=color:#e6db74>&#39;reference&#39;</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fromString</span>(<span style=color:#a6e22e>string</span> $reference)<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>($reference);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>equals</span>(<span style=color:#a6e22e>IdInterface</span><span style=color:#f92672>|</span><span style=color:#a6e22e>string</span> $other)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>\is_string</span>($other)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>uuid_compare</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reference</span>, $other);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$other <span style=color:#a6e22e>instanceof</span> <span style=color:#a6e22e>self</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>uuid_compare</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reference</span>, $other<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reference</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isNil</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>uuid_is_null</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reference</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__toString</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reference</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>Caractéristiques de cet identifiant :</strong></p><ul><li><strong>Type safety</strong> : Implémentation d&rsquo;interfaces spécifiques</li><li><strong>Validation</strong> : Vérification du format UUID</li><li><strong>Factory methods</strong> : Méthodes statiques pour créer des instances</li><li><strong>Comparaison</strong> : Méthode <code>equals()</code> pour la comparaison</li><li><strong>URI support</strong> : Parsing et génération d&rsquo;URIs</li><li><strong>Immutabilité</strong> : <code>readonly</code> class</li></ul><h3 id=-références-aux-adr-du-projet-gyroscops-cloud>📚 Références aux ADR du projet Gyroscops Cloud <a href=#-r%c3%a9f%c3%a9rences-aux-adr-du-projet-gyroscops-cloud class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Ces exemples suivent les patterns établis dans les Architecture Decision Records du projet Gyroscops Cloud :</p><ul><li><strong><a href=https://github.com/yourusername/hive/blob/main/architecture/HIVE040-enhanced-models-with-property-access-patterns.md rel=external target=_blank>HIVE040<svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M14 5c-.552.0-1-.448-1-1s.448-1 1-1h6c.552.0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1V6.414l-7.293 7.293c-.391.39-1.024.39-1.414.0-.391-.391-.391-1.024.0-1.414L17.586 5H14zM5 7c-.552.0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552.0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1V19c0 1.657-1.343 3-3 3H5c-1.657.0-3-1.343-3-3V8c0-1.657 1.343-3 3-3h4.563c.552.0 1 .448 1 1s-.448 1-1 1H5z"/></svg></a></strong> : Enhanced Models with Property Access Patterns - Patterns de modèles riches avec accès aux propriétés</li><li><strong><a href=https://github.com/yourusername/hive/blob/main/architecture/HIVE005-common-identifier-model-interfaces.md rel=external target=_blank>HIVE005<svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M14 5c-.552.0-1-.448-1-1s.448-1 1-1h6c.552.0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1V6.414l-7.293 7.293c-.391.39-1.024.39-1.414.0-.391-.391-.391-1.024.0-1.414L17.586 5H14zM5 7c-.552.0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552.0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1V19c0 1.657-1.343 3-3 3H5c-1.657.0-3-1.343-3-3V8c0-1.657 1.343-3 3-3h4.563c.552.0 1 .448 1 1s-.448 1-1 1H5z"/></svg></a></strong> : Common Identifier Model Interfaces - Interfaces communes pour les identifiants</li><li><strong><a href=https://github.com/yourusername/hive/blob/main/architecture/HIVE004-opaque-and-secret-data-objects.md rel=external target=_blank>HIVE004<svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M14 5c-.552.0-1-.448-1-1s.448-1 1-1h6c.552.0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1V6.414l-7.293 7.293c-.391.39-1.024.39-1.414.0-.391-.391-.391-1.024.0-1.414L17.586 5H14zM5 7c-.552.0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552.0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1V19c0 1.657-1.343 3-3 3H5c-1.657.0-3-1.343-3-3V8c0-1.657 1.343-3 3-3h4.563c.552.0 1 .448 1 1s-.448 1-1 1H5z"/></svg></a></strong> : Opaque and Secret Data Objects - Objets de données sécurisés</li><li><strong><a href=https://github.com/yourusername/hive/blob/main/architecture/HIVE003-dates-management.md rel=external target=_blank>HIVE003<svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M14 5c-.552.0-1-.448-1-1s.448-1 1-1h6c.552.0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1V6.414l-7.293 7.293c-.391.39-1.024.39-1.414.0-.391-.391-.391-1.024.0-1.414L17.586 5H14zM5 7c-.552.0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552.0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1V19c0 1.657-1.343 3-3 3H5c-1.657.0-3-1.343-3-3V8c0-1.657 1.343-3 3-3h4.563c.552.0 1 .448 1 1s-.448 1-1 1H5z"/></svg></a></strong> : Dates Management - Gestion des dates et timezones</li></ul><h2 id=transformation-dun-modèle-anémique>Transformation d&rsquo;un Modèle Anémique <a href=#transformation-dun-mod%c3%a8le-an%c3%a9mique class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=avant--modèle-anémique>Avant : Modèle Anémique <a href=#avant--mod%c3%a8le-an%c3%a9mique class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ❌ Modèle Anémique
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Order</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $id,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $customerId,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>array</span> $items,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>float</span> $total,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>string</span> $status
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Getters et setters uniquement
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getId</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>id</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getCustomerId</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>customerId</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getItems</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>array</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>items</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setItems</span>(<span style=color:#66d9ef>array</span> $items)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>items</span> <span style=color:#f92672>=</span> $items; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getTotal</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>float</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>total</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setTotal</span>(<span style=color:#a6e22e>float</span> $total)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>total</span> <span style=color:#f92672>=</span> $total; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getStatus</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> { <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setStatus</span>(<span style=color:#a6e22e>string</span> $status)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span> { $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>=</span> $status; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Logique métier dans le service
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OrderService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>addItem</span>(<span style=color:#a6e22e>Order</span> $order, <span style=color:#a6e22e>string</span> $itemId, <span style=color:#a6e22e>int</span> $quantity, <span style=color:#a6e22e>float</span> $price)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $order<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getItems</span>()[] <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;id&#39;</span> <span style=color:#f92672>=&gt;</span> $itemId, <span style=color:#e6db74>&#39;quantity&#39;</span> <span style=color:#f92672>=&gt;</span> $quantity, <span style=color:#e6db74>&#39;price&#39;</span> <span style=color:#f92672>=&gt;</span> $price];
</span></span><span style=display:flex><span>        $order<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setTotal</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>calculateTotal</span>($order<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getItems</span>()));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>confirm</span>(<span style=color:#a6e22e>Order</span> $order)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($order<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getStatus</span>() <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;draft&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvalidStateException</span>(<span style=color:#e6db74>&#39;Order cannot be confirmed&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $order<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setStatus</span>(<span style=color:#e6db74>&#39;confirmed&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=après--modèle-riche>Après : Modèle Riche <a href=#apr%c3%a8s--mod%c3%a8le-riche class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// ✅ Modèle Riche
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Order</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>OrderId</span> $id,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>CustomerId</span> $customerId,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>OrderItems</span> $items,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Money</span> $total,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>OrderStatus</span> $status
</span></span><span style=display:flex><span>    ) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>create</span>(<span style=color:#a6e22e>OrderId</span> $id, <span style=color:#a6e22e>CustomerId</span> $customerId)<span style=color:#f92672>:</span> <span style=color:#a6e22e>self</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>self</span>(
</span></span><span style=display:flex><span>            $id,
</span></span><span style=display:flex><span>            $customerId,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>OrderItems</span><span style=color:#f92672>::</span><span style=color:#a6e22e>empty</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Money</span><span style=color:#f92672>::</span><span style=color:#a6e22e>zero</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>OrderStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>DRAFT</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>addItem</span>(<span style=color:#a6e22e>ItemId</span> $itemId, <span style=color:#a6e22e>Quantity</span> $quantity, <span style=color:#a6e22e>Money</span> $price)<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>canAddItems</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>OrderCannotAddItemsException</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>items</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>items</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>OrderItem</span>($itemId, $quantity, $price));
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>total</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>items</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>calculateTotal</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>confirm</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>canBeConfirmed</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>OrderCannotBeConfirmedException</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>OrderStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>CONFIRMED</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>canAddItems</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>OrderStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>DRAFT</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>canBeConfirmed</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>OrderStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>DRAFT</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>items</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isEmpty</span>()
</span></span><span style=display:flex><span>            <span style=color:#f92672>&amp;&amp;</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>total</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>isPositive</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=-tests-des-modèles-riches>🧪 Tests des Modèles Riches <a href=#-tests-des-mod%c3%a8les-riches class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=tests-unitaires-simplifiés>Tests Unitaires Simplifiés <a href=#tests-unitaires-simplifi%c3%a9s class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PaymentTest</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>TestCase</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[Test]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_can_be_created_with_valid_amount</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $payment <span style=color:#f92672>=</span> <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Money</span>(<span style=color:#ae81ff>100.0</span>, <span style=color:#a6e22e>Currency</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EUR</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#a6e22e>PaymentStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PENDING</span>, $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getStatus</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[Test]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_cannot_be_created_with_negative_amount</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>expectException</span>(<span style=color:#a6e22e>InvalidAmountException</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Money</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>100.0</span>, <span style=color:#a6e22e>Currency</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EUR</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#[Test]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_can_be_processed_when_pending</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>void</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $payment <span style=color:#f92672>=</span> <span style=color:#a6e22e>Payment</span><span style=color:#f92672>::</span><span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PaymentId</span><span style=color:#f92672>::</span><span style=color:#a6e22e>generate</span>(),
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Money</span>(<span style=color:#ae81ff>100.0</span>, <span style=color:#a6e22e>Currency</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EUR</span>)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>process</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Money</span>(<span style=color:#ae81ff>100.0</span>, <span style=color:#a6e22e>Currency</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EUR</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>assertEquals</span>(<span style=color:#a6e22e>PaymentStatus</span><span style=color:#f92672>::</span><span style=color:#a6e22e>PROCESSED</span>, $payment<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getStatus</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><div class=chapter-navigation><h2 class=chapter-nav-title>🎯 Votre Prochaine Étape</h2><p class=chapter-nav-subtitle>Maintenant que vous comprenez les concepts de base et que j'ai partagé mon expérience avec Gyroscops, quel est votre contexte ?</p><div class=chapter-options><div class=chapter-option data-color=green data-draft=true><div class=chapter-option-header><div class=chapter-option-letter>A</div><div><h3 class=chapter-option-title>Application simple, équipe junior, développement rapide</h3><p class=chapter-option-subtitle>Vous voulez une approche simple et efficace</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Équipe de 1-3 développeurs</li><li>Application monolithique</li><li>Peu d'intégrations externes</li><li>Développement rapide requis</li><li>Cohérence forte requise</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 30-45 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Repositories et Persistance
<span class=draft-indicator>📝</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=yellow data-draft=true><div class=chapter-option-header><div class=chapter-option-letter>B</div><div><h3 class=chapter-option-title>Système avec intégrations, besoin de découplage</h3><p class=chapter-option-subtitle>Vous voulez explorer l'architecture événementielle</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Équipe de 3-8 développeurs</li><li>Intégrations multiples</li><li>Besoin de découplage</li><li>Architecture distribuée</li><li>Équipe expérimentée</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 25-35 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Architecture Événementielle
<span class=draft-indicator>📝</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style><div class=chapter-option data-color=red><div class=chapter-option-header><div class=chapter-option-letter>C</div><div><h3 class=chapter-option-title>Je veux d'abord voir les options de stockage</h3><p class=chapter-option-subtitle>Vous voulez comprendre les patterns de repository</p></div></div><div class=chapter-option-content><div class=chapter-option-criteria><h4 class=chapter-option-criteria-title>Critères d'adoption :</h4><ul class=chapter-option-criteria-list><li>Besoin de comprendre la persistance</li><li>Implémentation technique importante</li><li>Choix de stockage à faire</li><li>Patterns de repository à maîtriser</li></ul></div><div class=chapter-option-footer><span class=chapter-option-time>⏱️ 30-45 minutes</span>
<span class="chapter-option-link chapter-option-link-disabled">Choix du Type de Stockage
<span class=coming-soon-indicator>🚧</span></span></div></div></div><style>.chapter-option-link-disabled{background:#9ca3af!important;color:#6b7280!important;cursor:not-allowed!important;opacity:.7}.chapter-option-link-disabled:hover{background:#9ca3af!important;color:#6b7280!important;transform:none!important;box-shadow:none!important}.chapter-option-link-disabled::after{display:none!important}.chapter-option[data-draft=true]{opacity:.8;border-style:dashed;border-color:#d1d5db}.chapter-option[data-draft=true] .chapter-option-letter{background:#9ca3af}.chapter-option[data-draft=true] .chapter-option-title{color:#6b7280}.chapter-option[data-draft=true] .chapter-option-subtitle{color:#9ca3af}.draft-indicator,.coming-soon-indicator{margin-left:.5rem;font-size:.875rem}.chapter-option[data-draft=true]{animation:draft-pulse 2s ease-in-out infinite}@keyframes draft-pulse{0%,100%{opacity:.8}50%{opacity:.6}}</style></div></div><style>.chapter-navigation{margin:2rem 0;padding:1.5rem;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);border-radius:12px;border-left:4px solid #3b82f6}.chapter-nav-title{margin:0 0 .5rem;font-size:1.5rem;font-weight:700;color:#1e293b}.chapter-nav-subtitle{margin:0 0 1.5rem;color:#64748b;font-size:1rem;line-height:1.6}.chapter-options{display:flex;flex-direction:column;gap:1rem}.chapter-option{background:#fff;border-radius:8px;padding:1.25rem;border:1px solid #e2e8f0;transition:all .2s ease;position:relative;overflow:hidden}.chapter-option:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.1);border-color:#3b82f6}.chapter-option::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--option-color,#6b7280);border-radius:0 2px 2px 0}.chapter-option-header{display:flex;align-items:center;margin-bottom:.75rem}.chapter-option-letter{display:inline-flex;align-items:center;justify-content:center;width:2rem;height:2rem;border-radius:50%;background:var(--option-color,#6b7280);color:#fff;font-weight:700;font-size:.875rem;margin-right:.75rem;flex-shrink:0}.chapter-option-title{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0;line-height:1.4}.chapter-option-subtitle{font-size:.875rem;color:#64748b;font-style:italic;margin:.25rem 0 0;line-height:1.4}.chapter-option-content{margin-left:2.75rem}.chapter-option-criteria{margin-bottom:.75rem}.chapter-option-criteria-title{font-size:.875rem;font-weight:600;color:#374151;margin:0 0 .5rem}.chapter-option-criteria-list{list-style:none;padding:0;margin:0}.chapter-option-criteria-list li{position:relative;padding-left:1.25rem;margin-bottom:.25rem;font-size:.875rem;color:#4b5563;line-height:1.4}.chapter-option-criteria-list li::before{content:'✓';position:absolute;left:0;color:#10b981;font-weight:600}.chapter-option-footer{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;padding-top:.75rem;border-top:1px solid #e5e7eb}.chapter-option-time{font-size:.875rem;color:#6b7280;font-weight:500}.chapter-option-link{display:inline-flex;align-items:center;padding:.5rem 1rem;background:var(--option-color,#6b7280);color:#fff!important;text-decoration:none!important;border-radius:6px;font-weight:600;font-size:.875rem;transition:all .2s ease;border:none;cursor:pointer}.chapter-option-link:hover{background:var(--option-color-dark,#4b5563);color:#fff!important;text-decoration:none!important;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.15)}.chapter-option-link:visited{color:#fff!important;text-decoration:none!important}.chapter-option-link:focus{color:#fff!important;text-decoration:none!important;outline:2px solid rgba(255,255,255,.5);outline-offset:2px}.chapter-option-link:active{color:#fff!important;text-decoration:none!important}.chapter-option-link::after{content:'→';margin-left:.5rem;transition:transform .2s ease;color:#fff!important}.chapter-option-link:hover::after{transform:translateX(2px);color:#fff!important}.chapter-navigation a{color:inherit;text-decoration:none}.chapter-navigation a:hover{color:inherit;text-decoration:none}.chapter-navigation a:visited{color:inherit;text-decoration:none}.chapter-navigation a:focus{color:inherit;text-decoration:none}.chapter-navigation a:active{color:inherit;text-decoration:none}.chapter-option[data-color=green]{--option-color:#10b981;--option-color-dark:#059669}.chapter-option[data-color=yellow]{--option-color:#f59e0b;--option-color-dark:#d97706}.chapter-option[data-color=red]{--option-color:#ef4444;--option-color-dark:#dc2626}.chapter-option[data-color=blue]{--option-color:#3b82f6;--option-color-dark:#2563eb}.chapter-option[data-color=purple]{--option-color:#8b5cf6;--option-color-dark:#7c3aed}.chapter-option[data-color=orange]{--option-color:#f97316;--option-color-dark:#ea580c}.chapter-option[data-color=teal]{--option-color:#14b8a6;--option-color-dark:#0d9488}.chapter-option[data-color=indigo]{--option-color:#6366f1;--option-color-dark:#4f46e5}.chapter-option[data-color=pink]{--option-color:#ec4899;--option-color-dark:#db2777}.chapter-option[data-color=cyan]{--option-color:#06b6d4;--option-color-dark:#0891b2}@media(max-width:768px){.chapter-navigation{padding:1rem}.chapter-option{padding:1rem}.chapter-option-content{margin-left:2.5rem}.chapter-option-footer{flex-direction:column;align-items:flex-start;gap:.75rem}.chapter-option-link{align-self:stretch;justify-content:center}}</style></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/chapitres/fondamentaux/chapitre-06-granularite-choix-architecturaux/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Chapitre 6 : Granularité des Choix Architecturaux</p></div></div></a></div><div class="col-sm-6 pt-2 doc-prev"><a class=ms-auto href=/chapitres/fondamentaux/chapitre-08-architecture-evenementielle/><div class="card h-100 my-1 text-end"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0">Chapitre 8 : Architecture Événementielle <i class="material-icons align-middle">navigate_next</i></p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>© 2025 Grégory Planchat. Tous droits réservés.</p></div></div></div><div class="row mt-3 pt-3 border-top"><div class=col-12><div class=text-center><h6 class="text-muted mb-2">Nos Sponsors</h6><p class="text-muted small mb-2">Merci à nos partenaires qui soutiennent cette initiative</p><div class="d-flex justify-content-center align-items-center flex-wrap gap-3"><div class=sponsor-item><a href=https://kiboko.fr target=_blank rel="noopener noreferrer" class="text-decoration-none d-inline-block"><img src=/logo-kiboko-fr.svg alt=Kiboko width=120 height=60 style=display:block;max-width:120px;height:auto></a></div><div class=sponsor-item><a href=https://gyroscops.com target=_blank rel="noopener noreferrer" class="text-decoration-none d-inline-block"><img src=/logo-gyroscops.svg alt=Gyroscops width=120 height=60 style=display:block;max-width:120px;height:auto></a></div></div></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script src=/docs/js/bootstrap.js defer></script><script type=text/javascript src=http://localhost:1313/docs/js/bundle.js defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    


    

    

    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>